try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8346ef40-c17d-47b1-aedb-c7f3542d0687",e._sentryDebugIdIdentifier="sentry-dbid-8346ef40-c17d-47b1-aedb-c7f3542d0687")}catch(e){}!function(){var e,t,i,r,a,n,l={57624:function(e,t,i){"use strict";var r,a,n,l,s=i(55679),o=i(54375);i(79742);var d=i(40949);let c=d.eT.Card,u={"":c,b:d.eT.Cardback,t:d.eT.Token};Object.fromEntries(Object.keys(u).map(e=>[u[e],e.length>0?e+":":e]));let h=[18,36,55,72,90,108,126,144,162,180,198,216,234,396,504,612];function f(e){return e.replaceAll(/ +(?= )/g,"").trim()}h[h.length-1],(r=n||(n={})).BackendSpecific="backendSpecific",r.SearchResults="searchResults",r.SampleCards="sampleCards",(a=l||(l={})).quantity="Quantity",a.frontQuery="Front",a.frontSelectedImage="Front ID",a.backQuery="Back",a.backSelectedImage="Back ID";let p=e=>e.replace(/^(.+?)(?:\..+)?$/,"$1"),m=e=>f(e.toLowerCase().replaceAll(/[\(\[].*?[\)\]]/g,"").replace("-"," ").replace(" the "," ").replace("â€™","'").replaceAll(/[!"#\$%&'\(\)\*\+,-\.\/:;<=>\?@\[\]\^_`{\|}~\/]/g,"").replaceAll(/[0123456789]/g,"").replaceAll(/^the (.*$)/g,"$1").normalize("NFD").replace(RegExp("\\p{Diacritic}","gu"),"")),g=e=>{let t=[...e.matchAll(/^(?:\{(.+)\} )?(.*?)$/g)][0];return[t[1],t[2]]};var y=i(19119),v=i(8327),T=i(45007);T.I0.withTypes(),T.v9.withTypes(),T.oR.withTypes();let b=(0,v.wc)({creators:{asyncThunk:v.eU}});v.hg.withTypes();let x={id:"string",name:"string",searchq:"string",cardType:"enum",extension:"enum",language:"enum",tags:"enum[]",dpi:"number",size:"number"};function F(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{searchTypeSettings:{fuzzySearch:t,filterCardbacks:!1},sourceSettings:{sources:Object.values(e).map(e=>[e.pk,!0])},filterSettings:{minimumDPI:0,maximumDPI:1500,maximumSize:30,languages:[],includesTags:[],excludesTags:["NSFW"]}}}let I=b({name:"searchSettings",initialState:F({}),reducers:{setSearchTypeSettings:(e,t)=>{e.searchTypeSettings=t.payload},setSourceSettings:(e,t)=>{e.sourceSettings=t.payload},setFilterSettings:(e,t)=>{e.filterSettings=t.payload}}}),{setSearchTypeSettings:w,setSourceSettings:S,setFilterSettings:k}=I.actions;I.reducer,(0,y.P1)(e=>e.searchSettings.sourceSettings.sources,e=>null!=e);var C=i(34339);let D=(e,t)=>{if(!e)return["",new Set];let i=new Set,r=Array.from(e.matchAll(/\(([^\(\)]+)\)|\[([^\[\]]+)\]/g)).map(e=>void 0!==e[1]?e[1]:e[2]),a=e;for(let e of r)for(let r of e.split(",").map(e=>e.trim())){let e=r.toLowerCase(),l=null;if(t.has(e))l=t.get(e);else for(let i of t.values()){var n;if(null===(n=i.aliases)||void 0===n?void 0:n.map(e=>e.toLowerCase()).includes(e)){l=i;break}}if(null===l)continue;i.add(l.name);let s=l;for(;null!==s.parent;){i.add(s.parent);let e=t.get(s.parent);if(e)s=e;else break}let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");for(;;){let e=new RegExp("\\(.*?(".concat(o,",? *).*?\\)|\\[.*?(").concat(o,",? *).*?\\]")),t=a.match(e);if(!t)break;for(let e=1;e<t.length;e++)if(void 0!==t[e]){let i=t[0],r=t[e],n=t.index+i.indexOf(r),l=n+r.length;a=a.slice(0,n)+a.slice(l);break}}}for(let[e,t]of[["( )",""],["()",""],["[ ]",""],["[]",""],["[, ","["],[", ]","]"],["(, ","("],[", )",")"]])a=a.replaceAll(e,t);return[f(a),i]};class O{unpackName(e){let[t,i]=g(this.name),[r,a]=D(i,e);return{language:t,name:r,tags:a}}getLanguage(e){let{language:t}=this.unpackName(e);return void 0===this.parent?t:null!=t?t:this.parent.getLanguage(e)}getTags(e){let{tags:t}=this.unpackName(e);return void 0===this.parent?t:t.union(this.parent.getTags(e))}getFullPath(e){let{name:t}=this.unpackName(e);return void 0===this.parent?[t]:[...this.parent.getFullPath(e),t]}constructor(e,t,i){this.params=e,this.name=t,this.parent=i}}class L{unpackName(e){let[t,i]=g(this.name),[r,a]=D(i,e);return{language:null!=t?t:this.folder.getLanguage(e),name:r,tags:a.union(this.folder.getTags(e))}}getCardType(){return this.folder.name.toLowerCase().startsWith("cardback")?d.eT.Cardback:this.folder.name.toLowerCase().startsWith("token")?d.eT.Token:d.eT.Card}async getFullPath(e){return[...this.folder.getFullPath(e),this.params.sourceType===d.PO.LocalFile?this.params.fileHandle.name:this.params.identifier]}async getImageId(e){if(this.params.sourceType===d.PO.LocalFile){let t=await this.getFullPath(e);return t?"./".concat(t.slice(1).join("/")):Math.random().toString()}throw Error("getImageId not implemented yet for other source types")}async getOramaCardDocument(e){let{language:t,name:i,tags:r}=this.unpackName(e);return{id:await this.getImageId(e),cardType:this.getCardType(),name:i,searchq:m(this.name),source:this.folder.name,dpi:10*Math.round(300*this.height/1110/10),extension:this.extension,size:this.size,params:this.params,language:null!=t?t:"English",tags:Array.from(r),lastModified:this.modifiedTime}}constructor(e,t,i,r,a,n,l){this.params=e,this.name=t,this.extension=i,this.size=r,this.modifiedTime=a,this.height=n,this.folder=l}}class P{async exploreFolder(e){let t=[e],i=[];for(;t.length>0;){let e=t.pop();if(void 0!==e){let r=await this.getAllImagesInsideFolder(e),a=await this.getAllFoldersInsideFolder(e);i.push(...r),t.push(...a.filter(e=>!e.name.startsWith("!")))}else break}return i}async indexFolder(e,t){let i=(0,s.Ue)({schema:x}),r=new Map((null!=t?t:[]).map(e=>[e.name.toLowerCase(),e])),a=await Promise.all((await this.exploreFolder(e)).map(e=>e.getOramaCardDocument(r)));return(0,s.eB)(i,a),{oramaDb:i,size:a.length}}}class z extends P{getSourceType(){return d.PO.LocalFile}async getAllFoldersInsideFolder(e){let t=[];if(e.params.sourceType===this.getSourceType())for await(let[i,r]of e.params.fileHandle)r instanceof FileSystemDirectoryHandle&&t.push(new O({fileHandle:r,identifier:void 0,sourceType:e.params.sourceType},r.name,e));return t}async getAllImagesInsideFolder(e){let t=[];if(e.params.sourceType===this.getSourceType()){for await(let[i,r]of e.params.fileHandle)if(r instanceof FileSystemFileHandle){let i=await r.getFile(),a=await (0,C.z)(i.stream());void 0!==a&&t.push(new L({fileHandle:r,identifier:void 0,sourceType:e.params.sourceType},p(r.name),a.type,i.size,new Date(i.lastModified),a.height,e))}}return t}}class H{hasLocalFilesDirectoryHandle(){var e;return(null===(e=this.localFilesIndex)||void 0===e?void 0:e.fileHandle)!==void 0}getLocalFilesDirectoryHandle(){var e;return null===(e=this.localFilesIndex)||void 0===e?void 0:e.fileHandle}async setLocalFilesDirectoryHandle(e,t){this.localFilesIndex={fileHandle:e,index:void 0}}async clearLocalFilesIndex(){this.localFilesIndex=void 0}getLocalFilesIndexSize(){var e,t;return null===(t=this.localFilesIndex)||void 0===t?void 0:null===(e=t.index)||void 0===e?void 0:e.size}async indexDirectory(e){var t;if((null===(t=this.localFilesIndex)||void 0===t?void 0:t.fileHandle)!==void 0){let t=await new z().indexFolder(new O({fileHandle:this.localFilesIndex.fileHandle,identifier:void 0,sourceType:d.PO.LocalFile},this.localFilesIndex.fileHandle.name,void 0),e);return this.localFilesIndex.index=t,{handle:this.localFilesIndex.fileHandle,size:this.localFilesIndex.index.size}}}search(e,t,i,r){var a,n,l,o;if((null===(n=this.localFilesIndex)||void 0===n?void 0:null===(a=n.index)||void 0===a?void 0:a.oramaDb)===void 0)return;let d=e.filterSettings.includesTags.length>0,c=e.filterSettings.excludesTags.length>0;return(0,s.yC)(null===(o=this.localFilesIndex)||void 0===o?void 0:null===(l=o.index)||void 0===l?void 0:l.oramaDb,{term:t?m(t):void 0,properties:["searchq"],limit:null!=r?r:1e6,exact:void 0!==t&&!e.searchTypeSettings.fuzzySearch,where:{and:[{cardType:{in:i}},...d?[{tags:{containsAny:e.filterSettings.includesTags}}]:[],...c?[{not:{tags:{containsAny:e.filterSettings.excludesTags}}}]:[],{dpi:{between:[e.filterSettings.minimumDPI,e.filterSettings.maximumDPI]}},{size:{lte:1e6*e.filterSettings.maximumSize}}]}}).hits}retrieveCardIdentifiers(e,t,i,r){let a=this.search(e,t,i,r);return void 0!==a?a.map(e=>e.id):void 0}editorSearch(e,t){let i={};for(let r of t)if(r.query){Object.prototype.hasOwnProperty.call(i,r.query)||(i[r.query]={CARD:[],CARDBACK:[],TOKEN:[]});let t=this.retrieveCardIdentifiers(e,r.query,[r.cardType]);void 0!==t&&(i[r.query][r.cardType]=t)}return i}retrieveCardbackIdentifiers(e){return this.retrieveCardIdentifiers(e.searchTypeSettings.filterCardbacks?e:F([],!1),void 0,[d.eT.Cardback])}getCardDocuments(e){var t,i;let r=null===(i=this.localFilesIndex)||void 0===i?void 0:null===(t=i.index)||void 0===t?void 0:t.oramaDb;return r?Object.fromEntries(e.reduce((e,t)=>{let i=(0,s.pW)(r,t);return void 0!==i&&e.push([i.id,this.translateOramaCardDocumentToCardDocument(i)]),e},[])):{}}getByID(e){var t,i;if(null===(i=this.localFilesIndex)||void 0===i?void 0:null===(t=i.index)||void 0===t?void 0:t.oramaDb)return(0,s.pW)(this.localFilesIndex.index.oramaDb,e)}translateOramaCardDocumentToCardDocument(e){let t=e.lastModified.toLocaleDateString(void 0,{weekday:void 0,year:"numeric",month:"long",day:"numeric"});return{identifier:e.id,cardType:e.cardType,name:e.name,priority:0,source:e.source,sourceName:e.source,sourceId:0,sourceVerbose:e.source,sourceType:e.params.sourceType,sourceExternalLink:void 0,dpi:e.dpi,searchq:e.searchq,extension:e.extension,dateCreated:t,dateModified:t,size:e.size,smallThumbnailUrl:void 0,mediumThumbnailUrl:void 0,language:"EN",tags:e.tags}}getSampleCards(){return this.hasLocalFilesDirectoryHandle()?Object.fromEntries([d.eT.Card,d.eT.Cardback,d.eT.Token].map(e=>{var t;return[e,this.hasLocalFilesDirectoryHandle()?null===(t=this.search(F([],!1),void 0,[e],e===d.eT.Card?4:1))||void 0===t?void 0:t.map(e=>this.translateOramaCardDocumentToCardDocument(e.document)):[]]})):void 0}constructor(){this.localFilesIndex=void 0}}let A=new H;(0,o.Jj)(A)}},s={};function o(e){var t=s[e];if(void 0!==t)return t.exports;var i=s[e]={exports:{}},r=!0;try{l[e](i,i.exports,o),r=!1}finally{r&&delete s[e]}return i.exports}o.m=l,o.x=function(){var e=o.O(void 0,[774,634,949],function(){return o(57624)});return o.O(e)},e=[],o.O=function(t,i,r,a){if(i){a=a||0;for(var n=e.length;n>0&&e[n-1][2]>a;n--)e[n]=e[n-1];e[n]=[i,r,a];return}for(var l=1/0,n=0;n<e.length;n++){for(var i=e[n][0],r=e[n][1],a=e[n][2],s=!0,d=0;d<i.length;d++)l>=a&&Object.keys(o.O).every(function(e){return o.O[e](i[d])})?i.splice(d--,1):(s=!1,a<l&&(l=a));if(s){e.splice(n--,1);var c=r();void 0!==c&&(t=c)}}return t},o.d=function(e,t){for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce(function(t,i){return o.f[i](e,t),t},[]))},o.u=function(e){return 774===e?"static/chunks/framework-bbb84ebcce802aa9.js":"static/chunks/"+e+"."+({634:"fd6a23879f8b3aa8",949:"b852a96ba6638c21"})[e]+".js"},o.miniCssF=function(e){},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.tt=function(){return void 0===t&&(t={createScriptURL:function(e){return e}},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(t=trustedTypes.createPolicy("nextjs#bundler",t))),t},o.tu=function(e){return o.tt().createScriptURL(e)},o.p="/_next/",i={624:1},o.f.i=function(e,t){i[e]||importScripts(o.tu(o.p+o.u(e)))},a=(r=self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push.bind(r),r.push=function(e){var t=e[0],r=e[1],n=e[2];for(var l in r)o.o(r,l)&&(o.m[l]=r[l]);for(n&&n(o);t.length;)i[t.pop()]=1;a(e)},n=o.x,o.x=function(){return Promise.all([774,634,949].map(o.e,o)).then(n)},_N_E=o.x()}();