try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="67a25a99-b77a-457d-8319-6a1d815ff567",e._sentryDebugIdIdentifier="sentry-dbid-67a25a99-b77a-457d-8319-6a1d815ff567")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[154],{1832:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/editor",function(){return n(6781)}])},6781:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return td}});var s=n(5893),r=n(9008),l=n.n(r),i=n(9984),a=n(139),o=n(7294),c=n(8070),d=n(9101),u=n(2435),h=n(1027),x=n(6960),m=n(7340),j=n(6829),f=n(1296),g=n(4101),p=n(949),b=n(88),v=n(2941),y=n(8043),C=n(6419),w=n(4605),I=n(9887);function Z(e){let{items:t,collapseFrom:n="end",minVisibleItems:r=0,tagName:l="div",className:i="",alwaysRenderOverflow:a=!1,overflowRenderer:c,itemRenderer:d}=e,[u,h]=o.useState({visible:t,overflow:[],lastOverflowCount:0,overflowDirection:"none",opacity:0}),x=o.useRef(null);(0,v.Z)(()=>{j(!1)},[u]),(0,y.Z)(()=>{j(!1)}),(0,C.Z)(()=>{h(()=>({overflowDirection:"none",lastOverflowCount:0,overflow:[],visible:t,opacity:0}))},[t]);let m=0!==u.overflow.length||a?c(u.overflow):null,j=(0,o.useCallback)(t=>{x.current&&(t?h(t=>({overflowDirection:"grow",lastOverflowCount:"none"===t.overflowDirection?t.overflow.length:t.lastOverflowCount,overflow:[],visible:e.items,opacity:0})):x.current.getBoundingClientRect().width<.9?h(e=>{if(e.visible.length<=r)return e;let t="start"===n,s=e.visible.slice(),l=t?s.shift():s.pop();if(!l)return e;let i=t?[...e.overflow,l]:[l,...e.overflow];return{...e,direction:"none"===e.overflowDirection?"shrink":e.overflowDirection,overflow:i,visible:s,opacity:0}}):h(e=>({...e,overflowDirection:"none",opacity:1})))},[n,r,e.items]),[f,{width:g}]=(0,w.Z)(),p=(0,I.Z)(g);return(0,o.useEffect)(()=>{p&&j(g>p)},[g,p]),(0,s.jsxs)(l,{ref:f,className:i,style:{display:"flex",flexWrap:"nowrap",minWidth:0,opacity:u.opacity},children:["start"===n?m:null,u.visible.map(d),"end"===n?m:null,(0,s.jsx)("div",{style:{flexShrink:1,width:1},ref:x})]})}var k=n(3330),S=n(6720),N=n(7137),T=n(7346),F=n(1540);function G(e){let{children:t,expanded:n,onClick:r,zIndex:l,title:i,subtitle:a,sticky:o=!1}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:o?"sticky-top":"",onClick:r,style:{backgroundColor:"#4E5D6B",zIndex:l+100},children:[(0,s.jsx)("hr",{className:"mt-0"}),(0,s.jsxs)(g.Z,{direction:"horizontal",gap:2,className:"d-flex ps-3 pe-3",children:[i,a&&(0,s.jsx)("h6",{className:"text-primary prevent-select",children:a}),(0,s.jsx)("button",{className:"ms-auto bg-transparent border-0",children:(0,s.jsx)("h4",{className:"bi bi-chevron-left rotate-".concat(n?"":"neg","90"),style:{transition:"all 0.25s 0s"}})})]}),(0,s.jsx)("hr",{className:"mb-0"})]}),(0,s.jsx)("div",{className:"py-2"}),(0,s.jsx)(F.Z,{in:n,children:(0,s.jsx)("div",{children:t})})]})}var L=n(3389);let E=e=>{let{initialVisible:t=!1,defaultHeight:n=300,visibleOffset:r=1e3,stayRendered:l=!1,root:i=null,rootElement:a="div",rootElementClass:c="",placeholderElement:d="div",placeholderElementClass:u="",children:h}=e,[x,m]=(0,o.useState)(t),j=(0,o.useRef)(t),f=(0,o.useRef)(null),g=(0,o.useRef)(null),[p,b]=(0,o.useState)(n);(0,o.useEffect)(()=>{if(g.current){let e=g.current,t=new ResizeObserver(e=>{let t=e[0];b(e=>e===n&&(null==t?void 0:t.contentRect.height)!==0||(null==t?void 0:t.contentRect.height)>e?null==t?void 0:t.contentRect.height:e)});return t.observe(e),()=>{e&&t.unobserve(e)}}return()=>{}},[g,b,n]),(0,o.useEffect)(()=>{if(f.current){let e=f.current,t=new IntersectionObserver(e=>{window.requestIdleCallback?window.requestIdleCallback(()=>m(e[0].isIntersecting),{timeout:600}):m(e[0].isIntersecting)},{root:i,rootMargin:"".concat(r,"px 0px ").concat(r,"px 0px")});return t.observe(e),()=>{e&&t.unobserve(e)}}return()=>{}},[]),(0,o.useEffect)(()=>{x&&(j.current=!0)},[x]);let v=(0,o.useMemo)(()=>({height:"".concat(p,"px")}),[p]),y=(0,o.useMemo)(()=>"renderIfVisible ".concat(c),[c]),C=(0,o.useMemo)(()=>"renderIfVisible-placeholder ".concat(u),[u]);return o.createElement(a,{ref:f,className:y,style:v},(0,s.jsx)("div",{ref:g,children:x||l&&j.current?(0,s.jsx)(s.Fragment,{children:h}):o.createElement(d,{className:C})}))};var D=n(502),q=n(3825),V=n(8739),B=n(4706);function O(e){let{identifier:t,index:n,selectImage:r,selectedImage:l}=e;return(0,s.jsx)(D.LL,{imageIdentifier:t,cardHeaderTitle:"Option ".concat(n+1),cardOnClick:r&&(()=>r(t)),noResultsFound:!1,highlight:t===l},"gridSelector-".concat(t))}function R(e){let{children:t}=e;return(0,s.jsx)(d.Z,{className:"g-0 px-3",xxl:6,xl:6,lg:4,md:3,sm:2,xs:2,children:t})}function M(e){let{imageIdentifiers:t,selectImage:n,selectedImage:r,originalIndexMap:l}=e;return(0,s.jsx)(R,{children:t.map((e,t)=>{var i;let a=null!==(i=null==l?void 0:l.get(e))&&void 0!==i?i:t;return(0,s.jsx)(E,{initialVisible:t<20,visibleOffset:500,stayRendered:!0,children:(0,s.jsx)(O,{identifier:e,index:a,selectImage:n,selectedImage:r})},"gridSelector-".concat(e,"-wrapper"))})})}let z="__favorites__";function P(e){let{imageIdentifiers:t,selectImage:n,selectedImage:r,sourceNamesByKey:l,favoriteIdentifiers:i=[],originalIndexMap:a}=e,c=(0,u.TL)(),d=(0,u.CG)(B.Hm),h=(0,o.useMemo)(()=>new Set(i),[i]),x=(0,u.CG)(e=>(0,q.Ez)(e,t)),m=(0,o.useMemo)(()=>{let e=[],n={};t.forEach((t,s)=>{var r;let l=null!==(r=null==a?void 0:a.get(t))&&void 0!==r?r:s;h.has(t)&&e.push([t,l]);let i=x[t];null!=i&&(Object.prototype.hasOwnProperty.call(n,i.source)||(n[i.source]=[]),n[i.source].push([t,l]))});let s=[];for(let[t,i]of(e.length>0&&s.push({key:z,title:"Favorites",items:e}),Object.entries(n))){var r;s.push({key:t,title:null!==(r=l[t])&&void 0!==r?r:t,items:i})}return s},[x,t,h,l,a]);return(0,s.jsx)(s.Fragment,{children:m.map((e,t)=>{var l;return(0,s.jsxs)(o.Fragment,{children:[(0,s.jsx)(G,{expanded:null===(l=d[e.key])||void 0===l||l,onClick:()=>c((0,B.O6)(e.key)),zIndex:t,title:(0,s.jsx)("h3",{className:"orpheus prevent-select",style:{fontStyle:"italic"},children:e.title}),subtitle:"".concat(e.items.length," version").concat(1!=e.items.length?"s":""),sticky:!0,children:(0,s.jsx)(R,{children:e.items.map(e=>{let[t,l]=e;return(0,s.jsx)(E,{initialVisible:l<20,stayRendered:!0,children:(0,s.jsx)(O,{identifier:t,index:l,selectImage:n,selectedImage:r})},"gridSelector-".concat(t,"-wrapper"))})})}),(0,s.jsx)("div",{className:"py-2"})]},e.key)})})}function H(e){let{headerText:t,imageIdentifiers:n,selectedImage:r,handleClick:l,favoriteIdentifiers:a=[],originalIndexMap:o}=e,h=(0,u.TL)(),x=(0,u.CG)(B.Mj),m=(0,u.CG)(V.sn),j=(0,u.CG)(B.Ne),f=[z,...Object.keys(m)];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"px-3 pb-3",children:(0,s.jsxs)(d.Z,{children:[(0,s.jsx)("h4",{children:t}),(0,s.jsx)(c.Z,{md:8,sm:6,children:(0,s.jsxs)(g.Z,{direction:"horizontal",gap:2,children:[(0,s.jsx)("span",{className:"me-auto",children:"Show\xa0All\xa0Cards..."}),(0,s.jsx)(L.ZP,{onClick:()=>h((0,B.Mo)()),on:"Grouped By Source",onClassName:"flex-centre",off:"Grouped Together",offClassName:"flex-centre",onstyle:"success",offstyle:"info",width:"100%",size:"md",height:i.B4+"px",active:x})]})}),x&&(0,s.jsx)(c.Z,{md:4,sm:6,children:(0,s.jsx)("div",{className:"d-grid g-0",children:(0,s.jsxs)(S.Z,{onClick:()=>h(j?(0,B.X8)():(0,B.tC)(f)),children:[(0,s.jsx)(b.V9,{bootstrapIconName:"arrows-".concat(j?"expand":"collapse")})," ",j?"Expand":"Collapse"," All"]})})})]})}),x?(0,s.jsx)(P,{imageIdentifiers:n,selectImage:l,selectedImage:r,sourceNamesByKey:m,favoriteIdentifiers:a,originalIndexMap:o}):(0,s.jsx)(M,{imageIdentifiers:n,selectImage:l,selectedImage:r,sourceNamesByKey:m,originalIndexMap:o})]})}var _=n(9045);function A(e){let{title:t="Select Version",testId:n,imageIdentifiers:r,selectedImage:l,show:i,handleClose:a,onClick:h,searchq:x}=e,m=(0,u.TL)(),j=(0,u.CG)(B.H_),f=(0,u.CG)(_.mG),[g,p]=(0,o.useState)(void 0),[b,v]=(0,o.useState)(""),y=(0,o.useRef)(null),C=(0,o.useMemo)(()=>{let e=new Set(r);return Array.from(f).filter(t=>e.has(t))},[f,r]),w=(0,o.useMemo)(()=>{let e=new Set(C);return[...r].sort((t,n)=>{let s=e.has(t),r=e.has(n);return s&&!r?-1:!s&&r?1:0})},[r,C]),I=(0,o.useMemo)(()=>{let e=new Map;return r.forEach((t,n)=>e.set(t,n)),e},[r]),Z=(null!=g?g:0)>0&&(null!=g?g:0)<r.length+1||""!==b&&r.includes(b),k=(0,o.useCallback)(e=>{h(e),a()},[h,a]);return(0,s.jsxs)(T.Z,{scrollable:!0,show:i,onEntered:()=>{y.current&&y.current.focus()},onHide:a,size:"xl","data-testid":n,children:[(0,s.jsx)(T.Z.Header,{closeButton:!0,children:(0,s.jsx)(T.Z.Title,{children:t})}),(0,s.jsxs)(T.Z.Body,{className:"d-grid p-0",children:[(0,s.jsx)(G,{expanded:j,onClick:()=>m((0,B.e0)()),zIndex:0,title:(0,s.jsx)("h4",{children:"Jump to Version"}),children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(N.Z,{className:"px-3",id:"jumpToVersionForm",onSubmit:e=>{e.preventDefault(),k(g?r[g-1]:b)},children:[(0,s.jsxs)(d.Z,{className:"g-0",children:[(0,s.jsxs)(c.Z,{lg:3,md:5,children:[(0,s.jsxs)(N.Z.Label,{children:["Specify Option Number, ",(0,s.jsx)("b",{children:"or..."})]}),(0,s.jsx)(N.Z.Control,{ref:y,type:"number",pattern:"[0-9]*",placeholder:"1",value:g,onChange:e=>p(e.target.value?parseInt(e.target.value):void 0),disabled:!!b})]}),(0,s.jsxs)(c.Z,{lg:9,md:7,children:[(0,s.jsx)(N.Z.Label,{children:"Specify ID"}),(0,s.jsx)(N.Z.Control,{type:"text",placeholder:r[0],value:b,onChange:e=>v(e.target.value),disabled:!!g})]})]}),(0,s.jsx)("div",{className:"d-grid gap-0 pt-3",children:(0,s.jsx)(S.Z,{variant:"primary",form:"jumpToVersionForm",type:"submit","aria-label":"jump-to-version-submit",disabled:!Z,children:"Select This Version"})})]}),(0,s.jsx)("hr",{})]})}),(0,s.jsx)(H,{headerText:"Browse Versions",imageIdentifiers:w,handleClick:k,selectedImage:l,favoriteIdentifiers:C,originalIndexMap:I})]}),(0,s.jsx)(T.Z.Footer,{children:(0,s.jsx)(S.Z,{variant:"secondary",onClick:a,children:"Close"})})]})}var U=n(685),W=n(5303),X=n(6171),Q=n(470);function $(){let e=(0,m._)(["\n  font-size: 0.9em;\n  user-select: none;\n  -webkit-user-select: none;\n  white-space: nowrap;\n"]);return $=function(){return e},e}function K(){let e=(0,m._)(["\n  &:hover {\n    background-color: ",";\n  }\n  border-radius: 4px;\n  transition: background-color 0.1s ease-in-out;\n  cursor: pointer;\n"]);return K=function(){return e},e}function J(){let e=(0,m._)(["\n  position: relative;\n  top: calc(\n    50% - 20px\n  ); // can't use transform: translate(0, -50%) because it messes with the dropdown\n"]);return J=function(){return e},e}let Y=j.Z.p($()),ee=(0,j.Z)(Y)(K(),e=>(null==e?void 0:e.danger)?"rgba(255, 50, 50, 30%)":"rgba(100, 100, 100, 30%)");function et(e){let{children:t,onClick:n,inDropdown:r,danger:l=!1}=e;return r?(0,s.jsx)(f.Z.Item,{onClick:n,children:t}):(0,s.jsx)(ee,{onClick:n,className:"px-2 py-1 text-decoration-none",danger:l,children:t})}function en(e){let{slot:t,inDropdown:n}=e,r=(0,u.TL)();return(0,s.jsxs)(et,{onClick:()=>r((0,W.HS)({slot:t[1],face:t[0]})),inDropdown:n,children:[(0,s.jsx)(b.V9,{bootstrapIconName:"arrows-angle-expand"})," Select Similar"]})}function es(e){let{inDropdown:t}=e,n=(0,u.TL)(),r=(0,u.CG)(W.uq);return(0,s.jsxs)(et,{onClick:()=>n((0,W.fP)({selectedStatus:!0,slots:r})),inDropdown:t,children:[(0,s.jsx)(b.V9,{bootstrapIconName:"arrows-fullscreen"})," Select All"]})}function er(e){let{slots:t,inDropdown:n}=e,r=(0,u.TL)(),[l,i]=(0,o.useState)(!1),a=()=>i(!1),c=(0,u.CG)(e=>(0,W.CH)(e,t)),d=(0,u.CG)(e=>t.length>0?(0,X.ci)(e,null==c?void 0:c.query,null==c?void 0:c.cardType,t[0][0]):void 0);return t.length>0?(0,s.jsxs)(s.Fragment,{children:[null!=d&&d.length>1&&(0,s.jsxs)(et,{onClick:()=>i(!0),inDropdown:n,children:[(0,s.jsx)(b.V9,{bootstrapIconName:"image"})," Change Version"]}),null!=d&&(0,s.jsx)(A,{testId:"bulk-grid-selector",imageIdentifiers:d,show:l,handleClose:a,onClick:e=>{r((0,W.lE)({selectedImage:e,slots:t,deselect:!0})),a()}})]}):null}function el(e){let{slots:t,inDropdown:n}=e,r=(0,u.TL)();return(0,s.jsxs)(et,{onClick:()=>{r((0,U.Rd)({slots:t,query:null}))},inDropdown:n,children:[(0,s.jsx)(b.V9,{bootstrapIconName:"arrow-repeat"})," Change Query"]})}function ei(e){let{slots:t,inDropdown:n}=e,r=(0,u.TL)();return(0,s.jsxs)(et,{onClick:()=>r((0,W.It)({slots:t})),inDropdown:n,children:[(0,s.jsx)(b.V9,{bootstrapIconName:"slash-circle"})," Clear Query"]})}function ea(e){let{slots:t,inDropdown:n}=e,r=(0,u.TL)(),l=(0,q.zK)(),i=(0,k.j)(),a=(0,u.CG)(e=>(0,W.Tb)(e,t));return(0,s.jsxs)(et,{onClick:()=>{let e=0;a.forEach(t=>{l[t]&&l[t].sourceType===p.PO.GoogleDrive&&(i(l[t]),e++)}),r((0,W.fP)({selectedStatus:!1,slots:t})),r((0,Q.sc)([Math.random().toString(),{name:"Enqueued Downloads",message:"Enqueued ".concat(e," image download").concat(1!=e?"s":"","!"),level:"info"}]))},inDropdown:n,children:[(0,s.jsx)(b.V9,{bootstrapIconName:"cloud-arrow-down"})," Download Images"]})}function eo(e){let{slots:t,inDropdown:n}=e,r=(0,u.TL)(),l=t.map(e=>{let[t,n]=e;return n});return(0,s.jsxs)(et,{onClick:()=>r((0,W.Pm)({slots:l})),inDropdown:n,danger:!0,children:[(0,s.jsx)(b.V9,{bootstrapIconName:"x-circle"})," Delete Cards"]})}let ec=(0,j.Z)(g.Z)(J());function ed(){let e=(0,u.CG)(W.NV),t=(0,u.CG)(W.aG),n=(0,u.CG)(t=>(0,W.lO)(t,e)),r=(0,u.TL)(),l=(t,n)=>{switch(t){case"selectSimilar":return(0,s.jsx)(en,{slot:e[0],inDropdown:n},t);case"selectAll":return(0,s.jsx)(es,{inDropdown:n},t);case"changeSelectedImageSelectedImages":return(0,s.jsx)(er,{slots:e,inDropdown:n},t);case"changeSelectedImageQueries":return(0,s.jsx)(el,{slots:e,inDropdown:n},t);case"clearSelectedImageQueries":return(0,s.jsx)(ei,{slots:e,inDropdown:n},t);case"downloadSelectedImages":return(0,s.jsx)(ea,{slots:e,inDropdown:n},t);case"deleteSelectedImages":return(0,s.jsx)(eo,{slots:e,inDropdown:n},t)}},i=[...e.length>0?["changeSelectedImageSelectedImages","changeSelectedImageQueries"]:[],...e.length>0&&n?["downloadSelectedImages"]:[],...e.length>0&&!t?["deleteSelectedImages"]:[],...1===e.length?["selectSimilar"]:[],...t?[]:["selectAll"]];return(0,s.jsxs)(ec,{direction:"horizontal",className:"px-2",gap:0,children:[(0,s.jsxs)(Y,{className:"px-2",children:[(0,s.jsx)("b",{children:e.length})," card",1!=e.length&&"s"," selected."]}),e.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(et,{onClick:()=>r((0,W.fP)({selectedStatus:!1,slots:e})),inDropdown:!1,children:(0,s.jsx)("i",{className:"bi bi-x-lg"})}),(0,s.jsx)(Y,{children:"│"})]}),(0,s.jsx)("div",{className:"ms-auto"}),(0,s.jsx)(Z,{items:i,itemRenderer:(e,t)=>l(e,!1),overflowRenderer:e=>(0,s.jsxs)(f.Z,{children:[(0,s.jsx)(f.Z.Toggle,{style:{height:"29.6px"},variant:"secondary","data-testid":"more-select-options",children:(0,s.jsx)("i",{className:"bi bi-three-dots"})}),(0,s.jsx)(f.Z.Menu,{children:e.map(e=>l(e,!0))})]}),minVisibleItems:0,collapseFrom:"end"})]})}var eu=n(8583),eh=n(9724);function ex(e){let{searchResults:t,selectedImageIndex:n,selected:r,setSelectedImageFromIdentifier:l,handleShowGridSelector:i}=e,a=e=>{void 0!==n&&l(t[(0,eh.N0)(n+e,t.length)])};return(0,s.jsxs)(s.Fragment,{children:[1===t.length&&(0,s.jsxs)("p",{className:"mpccard-counter text-center align-middle",children:["1 / ",t.length]}),t.length>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(S.Z,{variant:r?"info":"outline-info",className:"mpccard-counter-btn",onClick:i,children:[(null!=n?n:0)+1," / ",t.length]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(S.Z,{variant:r?"info":"outline-info",className:"prev",onClick:()=>a(-1),children:"❮"}),(0,s.jsx)(S.Z,{variant:r?"info":"outline-info",className:"next",onClick:()=>a(1),children:"❯"})]})]})]})}let em=(0,o.memo)(function(e){let{face:t,slot:n,searchResultsForQuery:r,selectedImage:l,show:i,handleClose:a,setSelectedImageFromIdentifier:o,searchq:c}=e;return(0,s.jsx)(A,{testId:"".concat(t,"-slot").concat(n,"-grid-selector"),imageIdentifiers:r,selectedImage:l,show:i,handleClose:a,onClick:o,searchq:c})}),ej=(0,o.memo)(function(e){var t,n,r,l;let{searchQuery:i,face:a,slot:c}=e,d=(0,u.TL)(),h=(0,u.CG)(e=>(0,X.ci)(e,null==i?void 0:i.query,null==i?void 0:i.cardType,a)),x=(0,u.CG)(e=>(0,W.AN)(e,a,c)),m=null==x?void 0:x.selectedImage,j=(0,u.CG)(W.NV),f=(0,u.CG)(e=>(0,W.CH)(e,j)),g=j.length>1&&(null==x?void 0:x.selected)&&null!=f&&f.query===(null==i?void 0:i.query)&&f.cardType===(null==i?void 0:i.cardType)?j:[[a,c]],[p,b]=(0,o.useState)(!1),v=e=>{d((0,W.lE)({slots:g,selectedImage:e,deselect:!0}))},y=null!=h?h:[],C=null!=m?y.indexOf(m):void 0,w=null!=C?y[(0,eh.N0)(C+1,y.length)]:void 0,I=null!=C?y[(0,eh.N0)(C-1,y.length)]:void 0,Z="Slot ".concat(c+1),k=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:"card-select",onClick:e=>{2===e.detail?d((0,W.HS)({slot:c,face:a})):e.shiftKey?d((0,W.hb)({slot:c,face:a})):d((0,W.O$)({slot:c,face:a}))},"aria-label":"select-".concat(a).concat(c),children:(0,s.jsx)("i",{className:"bi bi".concat(null!==(t=null==x?void 0:x.selected)&&void 0!==t&&t?"-check":"","-square"),"aria-label":"".concat(a).concat(c,"-").concat(null!==(n=null==x?void 0:x.selected)&&void 0!==n&&n?"":"un","checked")})}),(0,s.jsx)("button",{className:"remove",children:(0,s.jsx)("i",{className:"bi bi-x-circle",onClick:()=>{d((0,W.Pm)({slots:[c]}))},"aria-label":"remove-".concat(a).concat(c)})})]}),S=(0,s.jsx)(ex,{searchResults:y,selectedImageIndex:C,selected:null!==(r=null==x?void 0:x.selected)&&void 0!==r&&r,setSelectedImageFromIdentifier:v,handleShowGridSelector:()=>b(!0)});return(0,s.jsxs)("div",{"data-testid":"".concat(a,"-slot").concat(c),children:[(0,s.jsx)(D.LL,{imageIdentifier:m,previousImageIdentifier:w,nextImageIdentifier:I,cardHeaderTitle:Z,cardFooter:S,cardHeaderButtons:k,searchQuery:i,nameOnClick:()=>{var e;d((0,U.Rd)({slots:[[a,c]],query:null!==(e=null==i?void 0:i.query)&&void 0!==e?e:null}))},noResultsFound:null!=h&&0===h.length}),y.length>1&&p&&(0,s.jsx)(em,{face:a,slot:c,searchResultsForQuery:y,selectedImage:m,show:p,handleClose:()=>b(!1),setSelectedImageFromIdentifier:v,searchq:null!==(l=null==i?void 0:i.query)&&void 0!==l?l:void 0})]})});function ef(){let e=(0,m._)(["\n  position: absolute;\n  border: 1px darkgray solid;\n  border-radius: 10px;\n  height: 100%;\n  width: 100%;\n  box-shadow: 0 0 50px 0 black inset;\n"]);return ef=function(){return e},e}function eg(){let e=(0,m._)(["\n  position: relative;\n  font-size: 1.25em;\n  text-align: center;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  text-shadow: 0 4px 15px #000000;\n  max-width: 90%;\n"]);return eg=function(){return e},e}let ep=j.Z.div(ef()),eb=j.Z.div(eg());function ev(){return(0,s.jsx)(ep,{children:(0,s.jsxs)(eb,{children:[(0,s.jsx)("p",{children:"Your project is empty at the moment."}),(0,s.jsxs)("p",{children:["Use the ",(0,s.jsx)("b",{children:"Add Cards"})," menu on the right to get started!"]})]})})}function ey(){let e=(0,u.CG)(e=>"loading"===e.searchResults.status),t=(0,u.CG)(W.aG),n=(0,u.CG)(B.ZR),r=(0,u.CG)(W.wH),l=[],a=[];for(let[e,t]of r.entries()){var o,c;l.push((0,s.jsx)(ej,{searchQuery:null===(o=t.front)||void 0===o?void 0:o.query,face:i.i6,slot:e},"".concat(i.i6,"-slot").concat(e))),a.push((0,s.jsx)(ej,{searchQuery:null===(c=t.back)||void 0===c?void 0:c.query,face:i.eJ,slot:e},"".concat(i.eJ,"-slot").concat(e)))}return(0,s.jsxs)(s.Fragment,{children:[0==r.length&&(0,s.jsx)(ev,{}),(0,s.jsx)(d.Z,{xxl:4,lg:3,md:2,sm:1,xs:1,className:"g-0",style:{display:n?"":"none"},children:l}),(0,s.jsx)(d.Z,{xxl:4,lg:3,md:2,sm:1,xs:1,className:"g-0",style:{display:n?"none":""},children:a}),(0,s.jsxs)(T.Z,{scrollable:!0,show:e&&!t,centered:!0,children:[(0,s.jsx)(T.Z.Header,{children:(0,s.jsx)(T.Z.Title,{style:{textAlign:"center",userSelect:"none"},className:"w-100",children:"Loading your cards..."})}),(0,s.jsx)(T.Z.Body,{children:(0,s.jsx)(eu.$,{})})]})]})}var eC=n(5102);let ew=(0,o.memo)(function(e){let{searchResults:t,show:n,handleClose:r}=e,l=(0,u.TL)(),a=(0,u.CG)(W.sZ);return(0,s.jsx)(A,{title:"Select Cardback",testId:"cardback-grid-selector",imageIdentifiers:t,selectedImage:a,show:n,handleClose:r,onClick:e=>{null!=a&&(l((0,W.Tx)({currentImage:a,selectedImage:e,face:i.eJ})),l((0,W.mp)({selectedImage:e})))}})});function eI(e){let{selectedImage:t}=e,n=(0,u.TL)(),r=(0,u.CG)(eC.yU),[l,a]=(0,o.useState)(!1),c=null!=t?r.indexOf(t):void 0,d=null!=c?r[(0,eh.N0)(c+1,r.length)]:void 0,h=null!=c?r[(0,eh.N0)(c-1,r.length)]:void 0,x=(0,s.jsx)(ex,{searchResults:r,selectedImageIndex:c,selected:!1,setSelectedImageFromIdentifier:e=>{null!=t&&null!=c&&(n((0,W.Tx)({currentImage:t,selectedImage:e,face:i.eJ})),n((0,W.mp)({selectedImage:e})))},handleShowGridSelector:()=>a(!0)});return(0,s.jsxs)("div",{"data-testid":"common-cardback",children:[(0,s.jsx)(D.LL,{imageIdentifier:t,previousImageIdentifier:d,nextImageIdentifier:h,cardHeaderTitle:"Cardback",cardFooter:x,noResultsFound:0===r.length}),l&&(0,s.jsx)(ew,{searchResults:r,show:l,handleClose:()=>a(!1)})]})}var eZ=n(8112),ek=n(5723),eS=n(1523);let eN=e=>(function(e){let t=e.reduce((e,t)=>(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=0),e[t]++,e),{});return Object.keys(t).sort().map(e=>"".concat(t[e],"x ").concat(e))})((function(e,t){function n(e){return null!=e&&null!=e.selectedImage&&Object.prototype.hasOwnProperty.call(t,e.selectedImage)&&t[e.selectedImage].cardType===i.Zb?(0,eZ.GL)(t[e.selectedImage].name):null}return e.map(e=>[n(e[i.i6]),n(e[i.eJ])])})((0,W.wH)(e),e.cardDocuments.cardDocuments).map(e=>null!=e[0]?null!=e[1]?"".concat(e[0]).concat(i.M0).concat(e[1]):e[0]:"").filter(e=>null!=e&&e.length>0)).join("\n");async function eT(e,t){let n=eN(e);return await (0,ek.Sv)(new Blob([n],{type:"text/plain;charset=utf-8"}),void 0,"decklist.txt",t),!0}function eF(){let e=(0,u.CG)(W.aG),t=function(){let e=(0,u.qr)(),t=(0,ek.Z9)(),{localFilesService:n}=(0,eS.d)();return()=>Promise.resolve(t("text","decklist.txt",()=>eT(e.getState(),n)))}();return(0,s.jsxs)(f.Z.Item,{disabled:e,onClick:t,"data-testid":"export-decklist-button",children:[(0,s.jsx)(b.V9,{bootstrapIconName:"card-text"})," Decklist"]})}function eG(){let e=(0,u.TL)(),t=(0,u.CG)(W.IH),n=(0,k.j)(),r=(0,q.zK)(),l=async()=>{let t=Object.values(r).filter(e=>e.sourceType===p.PO.GoogleDrive);t.map(n);let s=t.length;e((0,Q.sc)([Math.random().toString(),{name:"Enqueued Downloads",message:"Enqueued ".concat(s," image download").concat(1!=s?"s":"","!"),level:"info"}]))};return(0,s.jsxs)(f.Z.Item,{disabled:!t,onClick:l,children:[(0,s.jsx)(b.V9,{bootstrapIconName:"image"})," Card Images"]})}var eL=n(1793);function eE(){let e=(0,eL.Z)(),t=(0,u.CG)(W.aG);return(0,s.jsxs)(f.Z.Item,{disabled:t,onClick:e,"data-testid":"export-xml-button",children:[(0,s.jsx)(b.V9,{bootstrapIconName:"file-code"})," XML"]})}function eD(){return(0,s.jsxs)(f.Z,{children:[(0,s.jsx)("div",{className:"d-grid gap-0",children:(0,s.jsxs)(f.Z.Toggle,{variant:"secondary",id:"dropdown-basic",children:[(0,s.jsx)(b.V9,{bootstrapIconName:"cloud-arrow-down"})," Download"]})}),(0,s.jsxs)(f.Z.Menu,{children:[(0,s.jsx)(eE,{}),(0,s.jsx)(eG,{}),(0,s.jsx)(eF,{})]})]})}var eq=n(367),eV=n(8256);function eB(){let e=(0,u.TL)(),t=(0,u.CG)(eV.GG),n=!i.lq[t.cardstock];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{lg:8,md:12,sm:12,xs:12,children:(0,s.jsx)(N.Z.Group,{children:(0,s.jsx)(N.Z.Select,{value:t.cardstock,style:{height:i.B4+"px"},onChange:t=>e((0,eV.HU)(t.target.value)),children:i.Nu.map(e=>(0,s.jsx)("option",{children:e},e))})})}),(0,s.jsx)(c.Z,{lg:4,md:12,sm:12,xs:12,children:(0,s.jsx)(L.ZP,{onClick:()=>e((0,eV.uR)()),on:"Foil",onClassName:"flex-centre",off:"Non-Foil",offClassName:"flex-centre",onstyle:"success",offstyle:"info",width:"100%",size:"md",height:i.B4+"px",active:t.foil,disabled:n})})]})}var eO=n(8074);function eR(){let e=(0,m._)(["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n  border-width: 2px;\n  border-radius: 2px;\n  border-color: ",";\n  border-style: dashed;\n  color: #bdbdbd;\n  outline: none;\n  transition: border 0.24s ease-in-out;\n  cursor: pointer;\n"]);return eR=function(){return e},e}let eM=e=>e.isDragAccept?"#00e676":e.isDragReject?"#ff1744":e.isFocused?"#2196f3":"#eeeeee",ez=j.Z.div(eR(),e=>eM(e));function eP(e){let{mimeTypes:t,fileUploadCallback:n,label:r,disabled:l}=e,i=(0,u.TL)(),a=(0,o.useCallback)(()=>i((0,Q.sc)(["dropzone-onabort",{name:"File upload error",message:"File reading was stopped.",level:"error"}])),[i]),c=(0,o.useCallback)(()=>i((0,Q.sc)(["dropzone-onerror",{name:"File upload error",message:"An error occurred while reading the file.",level:"error"}])),[i]),d=(0,o.useCallback)(e=>{e.forEach(e=>{let t=new FileReader;t.onabort=a,t.onerror=c,t.onload=()=>{n(t.result)},t.readAsText(e)})},[n,a,c]),{getRootProps:h,getInputProps:x,isFocused:m,isDragAccept:j,isDragReject:f}=(0,eO.uI)({onDrop:d,accept:t,maxFiles:1,disabled:l});return(0,s.jsx)("div",{className:"container",children:(0,s.jsxs)(ez,{...h({isFocused:m,isDragAccept:j,isDragReject:f}),"aria-label":null!=r?r:"dropzone",children:[(0,s.jsx)("input",{...x()}),"Drag and drop a file here, or click to select a file."]})})}var eH=n(7482),e_=n(7709),eA=n(570);function eU(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eH.j,{headers:Object.values(i.bm),data:[,,,].fill([,,,,,].fill(null)),bordered:!0,uniformWidth:!0}),"Where the columns follow these rules:",(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("b",{children:i.bm.quantity}),": The quantity to include of this row. Must be greater than 0. Can be blank — if blank, a quantity of 1 will be assumed."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("b",{children:i.bm.frontQuery}),": Search query for card front."," ",(0,s.jsx)("b",{children:"Cannot be blank."})]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("b",{children:i.bm.frontSelectedImage}),": If this image is in the front search results, it will be pre-selected. Can be blank."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("b",{children:i.bm.backQuery}),": Search query for card back. Can be blank."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("b",{children:i.bm.backSelectedImage}),": If this image is in the back search results, it will be pre-selected. Can be blank."]})]})]})}function eW(){return(0,s.jsx)(eH.j,{headers:Object.values(i.bm),data:[[(0,s.jsx)("code",{children:"2"},"row-1-quantity"),(0,s.jsx)("code",{children:"island"},"row-1-front-query"),(0,s.jsx)("code",{children:"1HsvTYs..."},"row-1-front-id"),(0,s.jsx)("code",{children:"forest"},"row-1-back-query"),null],[(0,s.jsx)("code",{children:"3"},"row-2-quantity"),(0,s.jsx)("code",{children:"t:goblin"},"row-2-front-query"),null,null,(0,s.jsx)("code",{children:"1JtXL6C..."},"row-2-back-id")]],bordered:!0})}function eX(){let e=(0,u.TL)(),t=(0,e_.l)(),n=(0,u.CG)(eA.WP),r=(0,u.CG)(W.zO),[l,i]=(0,o.useState)(!1),a=()=>i(!1),c=t.isFetching;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(f.Z.Item,{onClick:()=>i(!0),children:[(0,s.jsx)(b.V9,{bootstrapIconName:"file-earmark-spreadsheet"})," CSV"]}),(0,s.jsxs)(T.Z,{scrollable:!0,show:l,onHide:a,"data-testid":"import-csv",children:[(0,s.jsx)(T.Z.Header,{closeButton:!0,children:(0,s.jsx)(T.Z.Title,{children:"Add Cards — CSV"})}),(0,s.jsxs)(T.Z.Body,{children:[(0,s.jsxs)("p",{children:["Upload a CSV file of cards to add to the project. The file must"," ",(0,s.jsx)("b",{children:"exactly"})," match the following format:"]}),(0,s.jsx)(eU,{}),"For example:",(0,s.jsx)(eW,{}),(0,s.jsx)("hr",{}),(0,s.jsx)(eP,{mimeTypes:{"text/csv":[".csv"]},fileUploadCallback:s=>{var l;if("string"!=typeof s){e((0,Q.sc)(["invalid-csv-contents",{name:"Invalid CSV file",message:"The contents of the uploaded file did not match the expected text format.",level:"error"}]));return}let i=(0,eZ.mR)(s),o=(0,eZ.l_)(i,null!==(l=t.data)&&void 0!==l?l:{},n);e((0,W.r7)({members:(0,eZ.wt)(o,r)})),a()},label:"import-csv",disabled:c})]}),(0,s.jsx)(T.Z.Footer,{children:(0,s.jsx)(S.Z,{variant:"secondary",onClick:a,children:"Close"})})]})]})}var eQ=n(1480);function e$(){let e=(0,u.TL)(),t=(0,e_.cf)(),n=(0,e_.l)(),r=(0,u.CG)(eA.WP),l=(0,u.CG)(W.zO),[a,c]=(0,o.useState)(!1),[d,h]=(0,o.useState)(""),x=(0,o.useRef)(null),m=()=>c(!1),j=n.isFetching,g=null!=t.data?(0,eZ.z8)(t.data):"";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(f.Z.Item,{onClick:()=>c(!0),children:[(0,s.jsx)(b.V9,{bootstrapIconName:"card-text"})," Text"]}),(0,s.jsxs)(T.Z,{scrollable:!0,show:a,onEntered:()=>{x.current&&x.current.focus()},onHide:m,"data-testid":"import-text",children:[(0,s.jsx)(T.Z.Header,{closeButton:!0,children:(0,s.jsx)(T.Z.Title,{children:"Add Cards — Text"})}),(0,s.jsxs)(T.Z.Body,{children:[(0,s.jsxs)("p",{children:["Type the names of the cards you'd like to add to your order and hit ",(0,s.jsx)("b",{children:"Submit"}),". One card per line."]}),(0,s.jsx)(eQ.Z,{children:(0,s.jsxs)(eQ.Z.Item,{eventKey:"0",children:[(0,s.jsx)(eQ.Z.Header,{children:"Syntax Guide"}),(0,s.jsx)(eQ.Z.Body,{children:(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:["There are three types of images in ",i.vV," —"," ",i.Zb.toLowerCase(),"s, ",i.dt.toLowerCase(),"s, and"," ",i.WU.toLowerCase(),"s. If you search for a card, the search results ",(0,s.jsx)("b",{children:"won't contain cardbacks or tokens"}),"."]}),(0,s.jsxs)("li",{children:[(0,s.jsxs)("b",{children:[(0,eh.LF)(i.Zb),"s"]})," are searched for by default."]}),(0,s.jsxs)("li",{children:["Search for ",(0,s.jsxs)("b",{children:[i.WU.toLowerCase(),"s"]})," by putting"," ",(0,s.jsx)("code",{children:i.P$[i.WU]})," at the start of the query — for example,"," ",(0,s.jsxs)("code",{children:[i.P$[i.WU],"your"," ",i.WU.toLowerCase()," name"]}),"."]}),(0,s.jsxs)("li",{children:["Search for ",(0,s.jsxs)("b",{children:[i.dt.toLowerCase(),"s"]})," by putting"," ",(0,s.jsx)("code",{children:i.P$[i.dt]})," at the start of the query — for example,"," ",(0,s.jsxs)("code",{children:[i.P$[i.dt],"your"," ",i.dt.toLowerCase()," name"]}),"."]}),(0,s.jsxs)("li",{children:["You may optionally specify the image ID to select by typing your search query, ",(0,s.jsx)("code",{children:i.A0}),", then the image ID — for example,"," ",(0,s.jsxs)("code",{children:["your ",i.Zb.toLowerCase()," name",i.A0,"1c4M-sK9gd0Xju0NXCPtqeTW_DQTldVU5"]}),"."]}),(0,s.jsxs)("li",{children:["You may specify queries for both the front and the back by separating them with ",(0,s.jsx)("code",{children:i.M0})," — for example,"," ",(0,s.jsxs)("code",{children:["4x goblin ",i.M0," ",i.P$[i.WU],"elf"]}),"."]}),(0,s.jsx)("li",{children:"If you don't specify a back query and your front query is a double-faced card, we will automatically query the back card for you."})]})})]})}),(0,s.jsx)("br",{}),(0,s.jsx)(N.Z,{id:"importTextForm",onSubmit:t=>{var s;t.preventDefault();let i=(0,eZ.ts)(d,null!==(s=n.data)&&void 0!==s?s:{},r);e((0,W.r7)({members:(0,eZ.wt)(i,l)})),h(""),m()},children:(0,s.jsx)(N.Z.Group,{className:"mb-3",children:(0,s.jsx)(N.Z.Control,{ref:x,as:"textarea",onKeyDown:e=>{var t;e.ctrlKey&&"Enter"===e.code&&(null===(t=x.current)||void 0===t?void 0:t.form)&&x.current.form.requestSubmit()},rows:12,placeholder:g,required:!0,onChange:e=>h(e.target.value),value:d,"aria-label":"import-text"})})}),(0,s.jsx)("p",{className:"text-sm-end my-0",children:(0,s.jsx)("i",{children:"Hint: Submit with Control+Enter."})})]}),(0,s.jsxs)(T.Z.Footer,{children:[(0,s.jsx)(S.Z,{variant:"secondary","aria-label":"import-text-close",onClick:m,children:"Close"}),(0,s.jsx)(S.Z,{variant:"primary",form:"importTextForm",type:"submit","aria-label":"import-text-submit",disabled:j,children:"Submit"})]})]})]})}var eK=n(755);function eJ(){var e;let t=(0,u.TL)(),n=(0,e_.l)(),r=(0,e_.QA)(),[l,i]=e_.hi.endpoints.queryImportSite.useLazyQuery(),a=(0,eK.Sb)(),c=(0,u.CG)(eA.WP),d=(0,u.CG)(W.zO),[h,x]=(0,o.useState)(""),[m,j]=(0,o.useState)(!1),[g,p]=(0,o.useState)(!1),v=(0,o.useRef)(null),y=()=>j(!1),C=(0,o.useCallback)(async e=>{if(e.preventDefault(),h.trim().length>0){p(!0);try{var s,r;let e=await l(h),i=(0,eZ.ts)(null!==(s=e.data)&&void 0!==s?s:"",null!==(r=n.data)&&void 0!==r?r:{},c);t((0,W.r7)({members:(0,eZ.wt)(i,d)})),y()}catch(e){t((0,Q.sc)(["url-import-error",{name:"URL Import Error",message:"An unexpected error occurred while processing your decklist: ".concat(e.message),level:"error"}]))}finally{p(!1)}}},[t,h,n.data,d,l,c]),w=g||r.isFetching||n.isFetching;return r.isFetching||0!==(null!==(e=r.data)&&void 0!==e?e:[]).length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z.Item,{onClick:()=>j(!0),disabled:r.isFetching,children:r.isFetching?(0,s.jsx)(eu.$,{size:1.5}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.V9,{bootstrapIconName:"link-45deg"})," URL"]})}),(0,s.jsxs)(T.Z,{scrollable:!0,show:g||m,onEntered:()=>{v.current&&v.current.focus()},onHide:y,onExited:()=>x(""),children:[(0,s.jsx)(T.Z.Header,{closeButton:!0,children:(0,s.jsx)(T.Z.Title,{children:"Add Cards — URL"})}),(0,s.jsxs)(T.Z.Body,{children:["Paste a link to a card list hosted on one of the below sites (not affiliated) to import the list into ",a,":",(0,s.jsx)("br",{}),null!=r.data?(0,s.jsx)("ul",{children:r.data.map(e=>(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:e.url,target:"_blank",children:e.name},e.name)},"".concat(e.name,"-row")))}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("br",{}),(0,s.jsx)(eu.$,{}),(0,s.jsx)("br",{})]}),(0,s.jsx)(N.Z,{id:"importURLForm",onSubmit:C,children:(0,s.jsx)(N.Z.Group,{className:"mb-3",children:(0,s.jsx)(N.Z.Control,{ref:v,type:"url",required:!0,placeholder:"https://",onChange:e=>x(e.target.value.trim()),value:h,disabled:g||null==r.data,"aria-label":"import-url"})})})]}),(0,s.jsxs)(T.Z.Footer,{children:[(0,s.jsx)(S.Z,{variant:"secondary",onClick:y,children:"Close"}),(0,s.jsx)(S.Z,{type:"submit",form:"importURLForm",variant:"primary",disabled:w,style:{width:"4.75em"},children:g?(0,s.jsx)(eu.$,{size:1.5}):"Submit"})]})]})]}):null}var eY=n(5273);function e0(){let e=(0,u.TL)(),t=(0,u.CG)(W.sZ),n=(0,u.CG)(W.zO),[r,l]=(0,o.useState)(!1),[a,c]=(0,o.useState)(!1),[d,h]=(0,o.useState)(!1),x=()=>l(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(f.Z.Item,{onClick:()=>l(!0),children:[(0,s.jsx)(b.V9,{bootstrapIconName:"file-code"})," XML"]}),(0,s.jsxs)(T.Z,{scrollable:!0,show:r,onHide:x,"data-testid":"import-xml",children:[(0,s.jsx)(T.Z.Header,{closeButton:!0,children:(0,s.jsx)(T.Z.Title,{children:"Add Cards — XML"})}),(0,s.jsxs)(T.Z.Body,{children:[(0,s.jsx)("p",{children:"Upload an XML file of cards to add to the project."}),(0,s.jsxs)("p",{children:["The ",i.vV," website can generate an XML file representing your project, and the ",i.vV," desktop tool which auto-fills your order into ",(0,s.jsx)(eY.d,{})," expects a file in this format."]}),(0,s.jsx)("div",{className:"px-0",children:(0,s.jsx)(L.ZP,{onClick:()=>c(!a),on:"Use XML Cardback",onClassName:"flex-centre",off:"Retain Selected Cardback",offClassName:"flex-centre",onstyle:"success",offstyle:"info",width:"100%",size:"md",height:i.B4+"px",active:a})}),(0,s.jsx)("div",{className:"pt-3",children:(0,s.jsx)(L.ZP,{onClick:()=>h(!d),on:"Use XML Finish Settings",onClassName:"flex-centre",off:"Retain Selected Finish Settings",offClassName:"flex-centre",onstyle:"success",offstyle:"info",width:"100%",size:"md",height:i.B4+"px",active:d})}),(0,s.jsx)("hr",{}),(0,s.jsx)(eP,{mimeTypes:{"text/xml":[".xml"]},fileUploadCallback:s=>{var r,l,o,c,u,h,m;if("string"!=typeof s){alert("invalid CSV file uploaded");return}let j=new DOMParser().parseFromString(s,"application/xml").getElementsByTagName("order")[0],f=j.getElementsByTagName("details")[0],g=null===(r=f.getElementsByTagName("stock")[0])||void 0===r?void 0:r.textContent,p=(null===(l=f.getElementsByTagName("foil")[0])||void 0===l?void 0:l.textContent)==="true",b=j.getElementsByTagName("fronts")[0],v=j.getElementsByTagName("backs")[0],y=b.getElementsByTagName("card"),C=null!=v?v.getElementsByTagName("card"):void 0,w=null!==(c=null===(o=j.getElementsByTagName("cardback")[0])||void 0===o?void 0:o.textContent)&&void 0!==c?c:t,I=0,Z=Array.from({length:i.Wn-n},()=>({front:null,back:null}));if(null!=C)for(let e of C){let t=null===(u=e.getElementsByTagName("slots")[0])||void 0===u?void 0:u.textContent;if(null==t)continue;let n=(0,eZ.XV)(null!==(h=e.getElementsByTagName("query")[0].textContent)&&void 0!==h?h:"");t.split(",").map(e=>parseInt(e)).forEach(t=>{var s;Z[t].back={query:n,selectedImage:null!==(s=e.getElementsByTagName("id")[0].textContent)&&void 0!==s?s:void 0,selected:!1},I=Math.max(I,t)})}for(let e of y){let t=e.getElementsByTagName("slots")[0].textContent;if(null==t)continue;let n=(0,eZ.XV)(null!==(m=e.getElementsByTagName("query")[0].textContent)&&void 0!==m?m:"");t.split(",").map(e=>parseInt(e)).forEach(t=>{var s;Z[t].front={query:n,selectedImage:null!==(s=e.getElementsByTagName("id")[0].textContent)&&void 0!==s?s:void 0,selected:!1},null==Z[t].back&&(Z[t].back={query:{query:null,cardType:i.dt},selectedImage:w,selected:!1}),I=Math.max(I,t)})}e((0,W.r7)({members:Z.slice(0,I+1)})),a&&null!=w&&e((0,W.mp)({selectedImage:w})),d&&null!=g&&i.Nu.includes(g)&&null!=p&&(e((0,eV.HU)(g)),e((0,eV.Mc)(p))),x()},label:"import-xml",disabled:!1})]}),(0,s.jsx)(T.Z.Footer,{children:(0,s.jsx)(S.Z,{variant:"secondary",onClick:x,children:"Close"})})]})]})}function e1(){return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(f.Z,{children:[(0,s.jsx)("div",{className:"d-grid gap-0",children:(0,s.jsxs)(f.Z.Toggle,{variant:"outline-success",id:"dropdown-basic",children:[(0,s.jsx)(b.V9,{bootstrapIconName:"plus-circle"})," Add Cards"]})}),(0,s.jsxs)(f.Z.Menu,{children:[(0,s.jsx)(e$,{}),(0,s.jsx)(e0,{}),(0,s.jsx)(eX,{}),(0,s.jsx)(eJ,{})]})]})})}var e2=n(5575),e9=n(6506),e5=n(9983),e4=n(9830);function e3(){let e=(0,u.TL)(),[t,n]=(0,o.useState)(!1),r=(0,u.CG)(eK.Sj),l=(0,u.CG)(eA.xN),[i,a]=(0,o.useState)(l.searchTypeSettings),[c,d]=(0,o.useState)(l.sourceSettings),[h,x]=(0,o.useState)(l.filterSettings),m=()=>n(!1),j=(0,o.useCallback)(()=>{a(l.searchTypeSettings),x(l.filterSettings),d(l.sourceSettings),n(!0)},[l]),f=()=>{(0,e2.Wm)({searchTypeSettings:i,sourceSettings:c,filterSettings:h}),e((0,eA.Fg)(i)),e((0,eA.Ph)(c)),e((0,eA._E)(h)),m()};return(0,s.jsxs)("div",{className:"d-grid gap-0",children:[(0,s.jsxs)(S.Z,{variant:"primary",onClick:j,children:[(0,s.jsx)(b.V9,{bootstrapIconName:"gear"}),"Search Settings"]}),(0,s.jsxs)(T.Z,{scrollable:!0,show:t,onHide:f,"data-testid":"search-settings",children:[(0,s.jsx)(T.Z.Header,{closeButton:!0,children:(0,s.jsx)(T.Z.Title,{children:"Search Settings"})}),(0,s.jsxs)(T.Z.Body,{children:[(0,s.jsx)(e5.I,{searchTypeSettings:i,setSearchTypeSettings:a}),(0,s.jsx)("hr",{}),(0,s.jsx)(e9.f,{filterSettings:h,setFilterSettings:x}),r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("hr",{}),(0,s.jsx)(e4.Q,{sourceSettings:c,setSourceSettings:d})]})]}),(0,s.jsxs)(T.Z.Footer,{children:[(0,s.jsx)(S.Z,{variant:"secondary",onClick:m,children:"Close Without Saving"}),(0,s.jsx)(S.Z,{variant:"primary",onClick:f,children:"Save Changes"})]})]})]})}function e7(e){let{children:t,variant:n,...r}=e;return(0,s.jsx)("div",{className:"bg-".concat(n," rounded-lg mt-2"),...r,children:(0,s.jsx)("div",{className:"p-3",children:t})})}var e6=n(9170);function e8(){let e=(0,u.TL)(),t=(0,u.CG)(e6.Cn),n=(0,u.CG)(e6.Jh);return n>0&&t.some(e=>(null==e?void 0:e.front)!=null||(null==e?void 0:e.back)!=null)?(0,s.jsxs)(e7,{variant:"primary",children:[(0,s.jsxs)("p",{children:["Your project specified ",(0,s.jsx)("b",{children:n})," card version",1!=n?"s":""," which couldn't be found."]}),(0,s.jsx)("div",{className:"d-grid gap-0",children:(0,s.jsx)(S.Z,{variant:"warning",onClick:()=>e((0,U.K4)("invalidIdentifiers")),children:"Review Invalid Cards"})})]}):null}var te=n(2238);function tt(){return"mobile"===(0,te.UAParser)().device.type?(0,s.jsxs)(e7,{variant:"primary",children:["It seems like you're on a mobile device! The ",i.vV," executable that auto-fills your order requires a desktop computer."]}):null}var tn=n(525);function ts(){let e=(0,u.CG)(B.ZR),t=(0,u.TL)();return(0,s.jsx)(L.ZP,{onClick:()=>t((0,B.$3)()),on:"Switch to Backs",onClassName:"flex-centre",off:"Switch to Fronts",offClassName:"flex-centre",onstyle:"info",offstyle:"info",width:"100%",size:"md",height:i.B4+"px",active:e})}function tr(){let e=(0,u.CG)(W.zO),t=(0,u.CG)(W.p4);return e>0?(0,s.jsxs)(e7,{variant:"secondary",children:[(0,s.jsxs)("p",{children:["Your project contains ",(0,s.jsx)("b",{children:e})," card",1!==e&&"s",", belongs in the bracket of up to"," ",(0,s.jsx)("b",{children:(0,eh.wk)(e)})," cards, and is"," ",(0,s.jsx)("b",{children:(0,eh.K)(t,0)})," in total."]}),e>=i.Wn&&(0,s.jsx)(tn.Z,{variant:"warning",children:"You've reached the maximum project size!"}),(0,s.jsx)(ts,{})]}):null}function tl(){return(0,u.CG)(e=>"loading"===e.cardDocuments.status)?(0,s.jsx)(e7,{variant:"primary",children:(0,s.jsxs)(g.Z,{direction:"horizontal",gap:2,className:"d-flex px-2",children:[(0,s.jsxs)("div",{className:"me-auto",children:[(0,s.jsx)("h5",{children:"Loading Card Data..."}),"Some search results may appear incomplete until this is finished."]}),(0,s.jsx)(eu.$,{size:2.5})]})}):null}function ti(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(tt,{}),(0,s.jsx)(tl,{}),(0,s.jsx)(e8,{}),(0,s.jsx)(tr,{})]})}var ta=function(){let e=(0,u.CG)(W.sZ),t=(0,u.CG)(W.aG);return(0,o.useEffect)(()=>{let e=e=>{if(!t)return e.preventDefault(),!1};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[t]),(0,s.jsxs)(d.Z,{className:"g-0",children:[(0,s.jsx)(x.V,{className:"g-0",children:(0,s.jsx)(ed,{})}),(0,s.jsx)(h.O,{lg:8,md:8,sm:6,xs:6,"data-testid":"left-panel",heightDelta:i.rE,children:(0,s.jsx)(ey,{})}),(0,s.jsxs)(h.O,{"data-testid":"right-panel",lg:4,md:4,sm:6,xs:6,style:{zIndex:1},className:"px-2",heightDelta:i.rE,children:[(0,s.jsx)(ti,{}),(0,s.jsx)(d.Z,{className:"g-0 pt-2",children:(0,s.jsx)(eB,{})}),(0,s.jsx)(d.Z,{className:"g-0 pt-2",children:(0,s.jsx)(e3,{})}),(0,s.jsxs)(d.Z,{className:"g-0 pt-2",children:[(0,s.jsx)(c.Z,{lg:7,md:12,sm:12,xs:12,children:(0,s.jsx)(e1,{})}),(0,s.jsx)(c.Z,{lg:5,md:12,sm:12,xs:12,children:(0,s.jsx)(eD,{})}),(0,s.jsx)(eq.y,{})]}),(0,s.jsx)(c.Z,{className:"g-0 pt-2",lg:{span:8,offset:2},md:12,children:(0,s.jsx)(eI,{selectedImage:e})})]})]})},to=n(2621);function tc(){return(0,eK.Cn)()?(0,s.jsx)(ta,{}):(0,s.jsx)(a.O,{requirement:"any"})}function td(){return(0,s.jsxs)(to.XR,{gutter:0,children:[(0,s.jsxs)(l(),{children:[(0,s.jsx)("title",{children:"Edit MPC Project"})," ",(0,s.jsx)("meta",{name:"description",content:"".concat(i.vV,"&apos;'s rich project editor.")})]}),(0,s.jsx)(tc,{})]})}n(7121)}},function(e){e.O(0,[62,490,204,712,888,774,179],function(){return e(e.s=1832)}),_N_E=e.O()}]);