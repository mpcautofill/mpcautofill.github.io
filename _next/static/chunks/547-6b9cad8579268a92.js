"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[547],{2283:function(e,t,r){r.d(t,{D_:function(){return S},Hz:function(){return k},QA:function(){return h},QZ:function(){return b},Xz:function(){return j},cf:function(){return g},gk:function(){return o},l:function(){return y},uX:function(){return x},zr:function(){return v}});var n=r(5673),l=r(848),a=r(1677),s=r(975),i=r(4641);let c=async(e,t,r)=>{let l=t.getState().backend.url,a=(0,n.ni)({baseUrl:l});return a(e,t,r)},o=(0,l.LC)({reducerPath:"apiSlice",baseQuery:c,tagTypes:[a.Fj.BackendSpecific],endpoints:e=>({getCards:e.query({query:e=>({url:"2/cards/",method:"POST",body:{card_identifiers:JSON.stringify(e)}}),providesTags:[a.Fj.BackendSpecific],transformResponse:(e,t,r)=>e.results}),getCardbacks:e.query({query:()=>({url:"2/cardbacks/",method:"GET"}),providesTags:[a.Fj.BackendSpecific],transformResponse:(e,t,r)=>e.cardbacks}),search:e.query({query:e=>({url:"2/searchResults/",method:"POST",body:JSON.stringify({searchSettings:e.searchSettings,queries:Array.from(e.queries)})}),providesTags:[a.Fj.BackendSpecific],transformResponse:(e,t,r)=>e.results}),getSources:e.query({query:()=>({url:"2/sources/",method:"GET"}),providesTags:[a.Fj.BackendSpecific],transformResponse:(e,t,r)=>e.results}),getImportSites:e.query({query:()=>({url:"2/importSites/",method:"GET"}),providesTags:[a.Fj.BackendSpecific],transformResponse:(e,t,r)=>e.import_sites}),queryImportSite:e.query({query:e=>({url:"2/importSiteDecklist/",method:"POST",body:JSON.stringify({url:e})}),providesTags:[a.Fj.BackendSpecific],transformResponse:(e,t,r)=>e.cards}),getDFCPairs:e.query({query:()=>({url:"2/DFCPairs/",method:"GET"}),providesTags:[a.Fj.BackendSpecific],transformResponse:(e,t,r)=>Object.fromEntries(Object.keys(e.dfc_pairs).map(t=>[(0,i.dG)(t),(0,i.dG)(e.dfc_pairs[t])]))}),getSampleCards:e.query({query:()=>({url:"2/sampleCards/",method:"GET"}),providesTags:[a.Fj.BackendSpecific],transformResponse:(e,t,r)=>e.cards}),getContributions:e.query({query:()=>({url:"2/contributions/",method:"GET"}),providesTags:[a.Fj.BackendSpecific]}),getBackendInfo:e.query({query:()=>({url:"2/info/",method:"GET"}),providesTags:[a.Fj.BackendSpecific],transformResponse:(e,t,r)=>e.info})})}),{useGetCardsQuery:u,useGetCardbacksQuery:d,useSearchQuery:m,useGetSourcesQuery:f,useGetImportSitesQuery:h,useQueryImportSiteQuery:p,useGetDFCPairsQuery:y,useGetSampleCardsQuery:g,useGetContributionsQuery:b,useGetBackendInfoQuery:v}=o;async function j(e,t){let r=await fetch((0,i.X8)(e,"/2/cards/"),{method:"POST",body:JSON.stringify({card_identifiers:Array.from(t)}),credentials:"same-origin",headers:(0,s.ho)()}),n=await r.json();return n.results}async function x(e){let t=await fetch((0,i.X8)(e,"/2/cardbacks/"),{method:"GET",credentials:"same-origin",headers:(0,s.ho)()}),r=await t.json();return r.cardbacks}async function S(e,t,r){let n=await fetch((0,i.X8)(e,"/2/searchResults/"),{method:"POST",body:JSON.stringify({searchSettings:t,queries:Array.from(r)}),credentials:"same-origin",headers:(0,s.ho)()}),l=await n.json();return l.results}async function k(e){let t=await fetch((0,i.X8)(e,"/2/sources/"),{method:"GET",credentials:"same-origin",headers:(0,s.ho)()}),r=await t.json();return r.results}},1677:function(e,t,r){var n;r.d(t,{A0:function(){return u},B4:function(){return g},B9:function(){return q},Ds:function(){return T},Em:function(){return D},Fj:function(){return n},Fo:function(){return a},M0:function(){return y},Ni:function(){return m},Ox:function(){return k},P$:function(){return f},WU:function(){return o},Wn:function(){return P},Zb:function(){return i},bD:function(){return w},dt:function(){return c},eJ:function(){return p},gx:function(){return S},i6:function(){return h},kw:function(){return C},mo:function(){return v},nS:function(){return Z},qY:function(){return d},sL:function(){return x},tm:function(){return b},vV:function(){return l},vs:function(){return s},xk:function(){return j},yl:function(){return I}});let l="MPC Autofill",a="MakePlayingCards.com",s="https://www.makeplayingcards.com",i="CARD",c="CARDBACK",o="TOKEN",u="@",d=":",m={"":i,b:c,t:o},f=Object.fromEntries(Object.keys(m).map(e=>[m[e],e.length>0?e+d:e])),h="front",p="back",y="|",g=38,b=50,v=40,j=1200,x=0,S=1500,k=50,w=30,q=1,Z="csrftoken",I="searchSettings",C="googleAnalyticsConsent",D="backendURL",T=[18,36,55,72,90,108,126,144,162,180,198,216,234,396,504,612],P=T[T.length-1];(n||(n={})).BackendSpecific="backendSpecific"},975:function(e,t,r){r.d(t,{j:function(){return y},ho:function(){return o},_m:function(){return m},Vs:function(){return h},cI:function(){return u},Y9:function(){return f},IT:function(){return p},Wm:function(){return d}});var n=r(1581),l=r.n(n),a=r(1955),s=r(1677);let i={title:"Search settings schema",type:"object",properties:{searchTypeSettings:{type:"object",properties:{fuzzySearch:{description:"Whether fuzzy search is enabled",type:"boolean"}},required:["fuzzySearch"]},sourceSettings:{type:"object",properties:{sources:{description:"The list of sources in the order they should be searched",type:["array","null"],items:{type:"array",items:[{type:"number",description:"The source's primary key",minimum:0},{type:"boolean",description:"Whether the source is enabled for searching"}],minItems:2,maxItems:2}}},required:["sources"]},filterSettings:{type:"object",properties:{minimumDPI:{type:"number",description:"The minimum DPI that cards must meet to be included in search results",minimum:0},maximumDPI:{type:"number",description:"The maximum DPI that cards can meet to be included in search results",minimum:0},maximumSize:{type:"number",description:"The maximum filesize that cards can have to be included in search results",minimum:0}},required:["minimumDPI","maximumDPI","maximumSize"]}},required:["searchTypeSettings","sourceSettings","filterSettings"],additionalProperties:!1},c=new(l());function o(){let e=a.Z.get(s.nS);if(null!=e)return{"X-CSRFToken":e}}function u(e){var t,r;let n=JSON.parse(null!==(t=localStorage.getItem(s.yl))&&void 0!==t?t:"{}"),l=c.compile(i),a=l(n);if(!a)return{searchTypeSettings:{fuzzySearch:!1},sourceSettings:{sources:Object.values(e).map(e=>[e.pk,!0])},filterSettings:{minimumDPI:s.sL,maximumDPI:s.gx,maximumSize:s.bD}};{let t=new Set(Object.values(e).map(e=>e.pk)),l=null!==(r=n.sourceSettings.sources)&&void 0!==r?r:[],a=new Set(l.map(e=>e[0]));return n.sourceSettings.sources=l.filter(e=>t.has(e[0])).concat(Array.from(t).filter(e=>!a.has(e)).map(e=>[e,!0])),n}}function d(e){localStorage.setItem(s.yl,JSON.stringify(e))}function m(){let e=a.Z.get(s.kw);return void 0!=e?!0===JSON.parse(e):void 0}function f(e){a.Z.set(s.kw,JSON.stringify(e),{expires:365,sameSite:"strict"})}function h(){return localStorage.getItem(s.Em)}function p(e){localStorage.setItem(s.Em,e)}function y(){localStorage.removeItem(s.Em)}},4641:function(e,t,r){r.d(t,{DE:function(){return d},GL:function(){return a},X8:function(){return m},XV:function(){return i},dG:function(){return s},l_:function(){return c},ts:function(){return o},wt:function(){return u}});var n=r(1677);function l(e){return e.replaceAll(/ +(?= )/g,"").trim()}function a(e){return l(e.replaceAll(/[([].*?[)\]]/g,""))}function s(e){return l(e.toLowerCase().trim().replace(/[~`!@#$%^&*(){}\[\];:"'<,.>?/\\|_+=]/g,""))}function i(e){for(let[t,r]of Object.entries(n.Ni))if(""!==t&&e.trimStart().toLowerCase().startsWith("".concat(t).concat(n.qY)))return{query:s(e.trimStart().slice(t.length+1)),card_type:r};return{query:s(e),card_type:n.Ni[""]}}function c(e,t){let r=[];return e.forEach(e=>{if(null!=e&&e.trim().length>0){let[l,a,s]=function(e,t){var r,l,a,s;let c,o;let[u,d,m]=function(e){var t;let r=e.replace(/\s+/g," ").trim(),l=RegExp("^(?:([0-9]*)?[xX]?\\s?(.*?)(?:".concat(n.A0,"([A-z0-9_\\-]*))?)?(?:(?:\\s*)").concat("\\"+n.M0,"(?:\\s*)(.+?)(?:").concat(n.A0,"([A-z0-9_\\-]*))?)?$"),"gm"),a=l.exec(r);return null==a?[0,null,null]:[parseInt(null!==(t=a[1])&&void 0!==t?t:"1"),[a[2],a[3]],[a[4],a[5]]]}(e),f=null;null!=d&&(null!==(r=d[0])&&void 0!==r?r:"").length>0&&(f=i(d[0]),c=null!==(l=d[1])&&void 0!==l?l:void 0);let h=null;return null!=m&&(null!==(a=m[0])&&void 0!==a?a:"").length>0?(h=i(m[0]),o=null!==(s=m[1])&&void 0!==s?s:void 0):null!=f&&(null==f?void 0:f.query)!=null&&f.query in t&&(h={query:t[f.query],card_type:n.Zb}),[u,null!=f?{query:f,selectedImage:c,selected:!1}:null,null!=h?{query:h,selectedImage:o,selected:!1}:null]}(e,t);l>0&&(null!=a||null!=s)&&r.push([l,a,s])}}),r}function o(e,t){return c(e.split(/\r?\n|\r|\n/g),t)}function u(e,t){let r=[];for(let[l,a,s]of e){let e=Math.min(l,n.Wn-(t+r.length));if((null!=a||null!=s)&&t+(r=[...r,...Array(e).fill({front:{query:null==a?void 0:a.query,selectedImage:null==a?void 0:a.selectedImage,selected:!1},back:{query:null==s?void 0:s.query,selectedImage:null==s?void 0:s.selectedImage,selected:!1}})]).length>=n.Wn)break}return r}function d(e){var t;let r=[...e.matchAll(/^(https?:\/\/)?(.*?)(?:\/.*)?$/gm)][0];return(null!==(t=r[1])&&void 0!==t?t:"https://")+r[2]}function m(e,t){return e+t}},8208:function(e,t,r){r.d(t,{K:function(){return a},N0:function(){return l},wk:function(){return s}});var n=r(1677);function l(e,t){return(e%t+t)%t}function a(e,t){let r=10**t,n=e/1e6;return n=Math.round(n*r)/r,"".concat(n," MB")}function s(e){for(let t of n.Ds)if(t>=e)return t;return n.Ds[n.Ds.length-1]}},8737:function(e,t,r){r.d(t,{If:function(){return i},LW:function(){return s},jb:function(){return a}});var n=r(1876);let l=(0,n.oM)({name:"backend",initialState:{url:null},reducers:{setURL:(e,t)=>{e.url=t.payload},clearURL:e=>{e.url=void 0}}}),{setURL:a,clearURL:s}=l.actions;t.ZP=l.reducer;let i=e=>e.backend.url},3152:function(e,t,r){r.d(t,{xu:function(){return a}});var n=r(1876),l=r(2283);let a=(0,n.hg)("cardbacks/fetchCardbacks",async(e,t)=>{let r=t.getState();return(0,l.uX)(r.backend.url)}),s=(0,n.oM)({name:"cardbacks",initialState:{cardbacks:[],status:"idle",error:null},reducers:{addCardbackDocuments:(e,t)=>{e.cardbacks=[...t.payload]}},extraReducers(e){e.addCase(a.pending,(e,t)=>{e.status="loading"}).addCase(a.fulfilled,(e,t)=>{e.status="succeeded",e.cardbacks=[...t.payload]}).addCase(a.rejected,(e,t)=>{e.status="failed",e.error=""})}});t.ZP=s.reducer},9539:function(e,t,r){r.d(t,{r7:function(){return C},HS:function(){return P},uA:function(){return R},Tx:function(){return k},fP:function(){return T},qe:function(){return Z},ND:function(){return w},ZP:function(){return N},NO:function(){return E},Ed:function(){return g},eY:function(){return y},aG:function(){return x},sZ:function(){return p},p4:function(){return b},LI:function(){return f},wH:function(){return d},zO:function(){return h},nZ:function(){return j},NV:function(){return m},Y:function(){return v},mp:function(){return I},qP:function(){return S},O$:function(){return D}});var n=r(1876),l=r(1677),a=r(4641),s=r(3518),i=r.n(s),c=r(8208);let o={members:[{front:{query:{query:"island",card_type:l.Zb},selectedImage:void 0,selected:!1},back:null},{front:{query:{query:"island",card_type:l.Zb},selectedImage:void 0,selected:!1},back:null},{front:{query:{query:"grim monolith",card_type:l.Zb},selectedImage:void 0,selected:!1},back:null},{front:{query:{query:"past in flames",card_type:l.Zb},selectedImage:void 0,selected:!1},back:null},{front:{query:{query:"necropotence",card_type:l.Zb},selectedImage:void 0,selected:!1},back:null}],cardback:null},u=(0,n.oM)({name:"project",initialState:o,reducers:{setSelectedImage:(e,t)=>{null==e.members[t.payload.slot][t.payload.face]?e.members[t.payload.slot][t.payload.face]={query:{query:null,card_type:l.Zb},selectedImage:t.payload.selectedImage,selected:!1}:e.members[t.payload.slot][t.payload.face].selectedImage=t.payload.selectedImage},bulkReplaceSelectedImage:(e,t)=>{let r=new Set;for(let[n,l]of e.members.entries())null!=l[t.payload.face]&&l[t.payload.face].selectedImage===t.payload.currentImage&&r.add(n);for(let n of r)null==e.members[n][t.payload.face]?e.members[n][t.payload.face]={query:{query:null,card_type:l.Zb},selectedImage:t.payload.selectedImage,selected:!1}:e.members[n][t.payload.face].selectedImage=t.payload.selectedImage},bulkSetSelectedImage:(e,t)=>{for(let[r,n]of t.payload.slots)null==e.members[n][r]?e.members[n][r]={query:{query:null,card_type:l.Zb},selectedImage:t.payload.selectedImage,selected:!1}:(e.members[n][r].selectedImage=t.payload.selectedImage,e.members[n][r].selected=!1)},setQuery:(e,t)=>{let r=(0,a.XV)(t.payload.query);null==e.members[t.payload.slot][t.payload.face]?e.members[t.payload.slot][t.payload.face]={query:r,selectedImage:void 0,selected:!1}:e.members[t.payload.slot][t.payload.face].query=r},bulkSetQuery:(e,t)=>{let r=(0,a.XV)(t.payload.query);for(let[n,l]of t.payload.slots)null==e.members[l][n]?e.members[l][n]={query:r,selectedImage:void 0,selected:!1}:(e.members[l][n].query=r,e.members[l][n].selected=!1)},setSelectedCardback:(e,t)=>{e.cardback=t.payload.selectedImage},addMembers:(e,t)=>{e.members=[...e.members,...t.payload.members.slice(0,l.Wn-e.members.length)]},toggleMemberSelection:(e,t)=>{var r;null!=(null!==(r=e.members[t.payload.slot])&&void 0!==r?r:{})[t.payload.face]&&(e.members[t.payload.slot][t.payload.face].selected=!e.members[t.payload.slot][t.payload.face].selected)},bulkSetMemberSelection:(e,t)=>{for(let[r,n]of t.payload.slots)null==e.members[n][r]?e.members[n][r]={query:{query:null,card_type:l.Zb},selectedImage:void 0,selected:t.payload.selectedStatus}:e.members[n][r].selected=t.payload.selectedStatus},bulkAlignMemberSelection:(e,t)=>{var r,n,l;let a=(null!==(r=e.members[t.payload.slot])&&void 0!==r?r:{})[t.payload.face];if(null!=a)for(let[r,s]of e.members.entries())null!=s[t.payload.face]&&(null===(n=s[t.payload.face].query)||void 0===n?void 0:n.query)===a.query.query&&(null===(l=s[t.payload.face].query)||void 0===l?void 0:l.card_type)===a.query.card_type&&(s[t.payload.face].selected=a.selected)},deleteSlot:(e,t)=>{e.members.splice(t.payload.slot,1)},bulkDeleteSlots:(e,t)=>{t.payload.slots.sort(function(e,t){return t-e}).forEach(function(t){e.members.splice(t,1)})}}}),d=e=>e.project.members,m=e=>e.project.members.flatMap((e,t)=>{var r,n;return((null===(r=e.front)||void 0===r?void 0:r.selected)===!0?[[l.i6,t]]:[]).concat((null===(n=e.back)||void 0===n?void 0:n.selected)===!0?[[l.eJ,t]]:[])}),f=e=>new Set(e.project.members.flatMap(e=>{var t,r,n,a;return((null===(t=e.front)||void 0===t?void 0:null===(r=t.query)||void 0===r?void 0:r.query)!=null?[l.P$[e.front.query.card_type]+e.front.query.query]:[]).concat((null===(n=e.back)||void 0===n?void 0:null===(a=n.query)||void 0===a?void 0:a.query)!=null?[l.P$[e.back.query.card_type]+e.back.query.query]:[])})),h=e=>e.project.members.length,p=e=>e.project.cardback,y=e=>(function(e,t,r,n){let a=function(e,t){let r={front:{},back:{}};for(let[n,a]of e.entries())for(let e of[l.i6,l.eJ]){let l=a[e];if(null!=l){let a=l.selectedImage;null!=a&&a!==t&&(null==r[e][a]?r[e][a]=new Set([n]):r[e][a].add(n))}}return r}(e,r),s=document.implementation.createDocument("","",null),o=s.createElement("order"),u=s.createElement("details"),d=s.createElement("quantity");d.appendChild(s.createTextNode(n.toString())),u.appendChild(d);let m=s.createElement("bracket");for(let e of(m.appendChild(s.createTextNode((0,c.wk)(n).toString())),u.appendChild(m),o.append(u),[l.i6,l.eJ]))if(Object.keys(a[e]).length>0){let n=s.createElement("".concat(e,"s"));for(let[i,c]of Object.entries(a[e])){let a=function(e,t,r,n){let a=e[r];if(null==a)return null;let s=t.createElement("card"),i=t.createElement("id");i.appendChild(t.createTextNode(r)),s.appendChild(i);let c=t.createElement("slots");c.appendChild(t.createTextNode(Array.from(n).sort((e,t)=>e-t).toString())),s.appendChild(c);let o=t.createElement("name");o.appendChild(t.createTextNode("".concat(a.name,".").concat(a.extension))),s.append(o);let u=t.createElement("query");return u.appendChild(t.createTextNode(l.P$[a.card_type]+a.searchq)),s.append(u),s}(t,s,i,c),o=i===r&&e===l.eJ;null==a||o||n.appendChild(a)}n.children.length>0&&o.appendChild(n)}let f=s.createElement("cardback");null!=r&&f.appendChild(s.createTextNode(r)),o.appendChild(f),s.appendChild(o);let h=new XMLSerializer,p=h.serializeToString(s);return i()(p,{collapseContent:!0})})(d(e),e.cardDocuments.cardDocuments,e.project.cardback,h(e)),g=e=>(function(e,t){let r=function(e,t){function r(e){return null!=e&&null!=e.selectedImage&&Object.prototype.hasOwnProperty.call(t,e.selectedImage)&&t[e.selectedImage].card_type===l.Zb?(0,a.GL)(t[e.selectedImage].name):null}return e.map(e=>[r(e[l.i6]),r(e[l.eJ])])}(e,t),n=r.map(e=>null!=e[0]?null!=e[1]?"".concat(e[0]," ").concat(l.M0," ").concat(e[1]):e[0]:"").filter(e=>null!=e&&e.length>0);return(function(e){let t=e.reduce((e,t)=>(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=0),e[t]++,e),{});return Object.keys(t).sort().map(e=>"".concat(t[e],"x ").concat(e))})(n).join("\n")})(d(e),e.cardDocuments.cardDocuments),b=e=>{let t=new Set;for(let r of e.project.members)for(let e of[l.i6,l.eJ])null!=r[e]&&null!=r[e].selectedImage&&t.add(r[e].selectedImage);let r=e.cardDocuments.cardDocuments;return Array.from(t).reduce((e,t)=>{var n;return e+(null!==(n=r[t])&&void 0!==n?n:{size:0}).size},0)},v=e=>{let t=new Set(e.cardbacks.cardbacks);for(let s of e.project.members)for(let i of[l.i6,l.eJ]){var r,n,a;let l=s[i];(null==l?void 0:null===(r=l.query)||void 0===r?void 0:r.query)!=null&&(null!==(a=(null!==(n=e.searchResults.searchResults[l.query.query])&&void 0!==n?n:{})[l.query.card_type])&&void 0!==a?a:[]).length>0&&e.searchResults.searchResults[l.query.query][l.query.card_type].forEach(e=>t.add(e))}return t},j=e=>{let t=[];for(let a of e.project.members)for(let s of[l.i6,l.eJ]){var r,n;let l=a[s];(null==l?void 0:null===(r=l.query)||void 0===r?void 0:r.query)!=null&&null==(null!==(n=e.searchResults.searchResults[l.query.query])&&void 0!==n?n:{})[l.query.card_type]&&t.push(l.query)}return t},x=e=>0==e.project.members.length,{setSelectedImage:S,bulkReplaceSelectedImage:k,bulkSetSelectedImage:w,setQuery:q,bulkSetQuery:Z,setSelectedCardback:I,addMembers:C,toggleMemberSelection:D,bulkSetMemberSelection:T,bulkAlignMemberSelection:P,deleteSlot:E,bulkDeleteSlots:R}=u.actions;var N=u.reducer},7088:function(e,t,r){r.d(t,{U9:function(){return c}});var n=r(1876),l=r(2283),a=r(3152),s=r(9539),i=r(5713);let c=(0,n.hg)("cardDocuments/fetchCardDocuments",async(e,t)=>{await t.dispatch((0,i.IA)()),await t.dispatch((0,a.xu)());let r=t.getState(),n=(0,s.Y)(r),c=new Set(Object.keys(r.cardDocuments.cardDocuments)),o=new Set(Array.from(n).filter(e=>!c.has(e)));if(o.size>0)return(0,l.Xz)(r.backend.url,o)}),o=(0,n.oM)({name:"cardDocuments",initialState:{cardDocuments:{},status:"idle",error:null},reducers:{addCardDocuments:(e,t)=>{e.cardDocuments={...e.cardDocuments,...t.payload}}},extraReducers(e){e.addCase(c.pending,(e,t)=>{e.status="loading"}).addCase(c.fulfilled,(e,t)=>{e.status="succeeded",e.cardDocuments={...e.cardDocuments,...t.payload}}).addCase(c.rejected,(e,t)=>{e.status="failed",e.error=""})}});t.ZP=o.reducer},5713:function(e,t,r){r.d(t,{IA:function(){return s},Ug:function(){return o}});var n=r(1876),l=r(2283),a=r(9539);let s=(0,n.hg)("searchResults/fetchCards",async(e,t)=>{let r=t.getState(),n=(0,a.nZ)(r);if(n.length>0)return(0,l.D_)(r.backend.url,r.searchSettings,n)}),i=(0,n.oM)({name:"searchResults",initialState:{searchResults:{},status:"idle",error:null},reducers:{addSearchResults:(e,t)=>{e.searchResults={...e.searchResults,...t.payload}},clearSearchResults:e=>{e.searchResults={}}},extraReducers(e){e.addCase(s.fulfilled,(e,t)=>{e.searchResults={...e.searchResults,...t.payload}}),e.addCase(s.rejected,(e,t)=>{alert("TODO")})}}),{addSearchResults:c,clearSearchResults:o}=i.actions;t.ZP=i.reducer},5582:function(e,t,r){r.d(t,{$:function(){return a},TK:function(){return i}});var n=r(1876),l=r(2283);let a=(0,n.hg)("sourceDocuments/fetchSourceDocuments",async(e,t)=>{let r=t.getState();return(0,l.Hz)(r.backend.url)}),s=(0,n.oM)({name:"sourceDocuments",initialState:{sourceDocuments:void 0},reducers:{addSourceDocuments:(e,t)=>{e.sourceDocuments={...e.sourceDocuments,...t.payload}}},extraReducers(e){e.addCase(a.fulfilled,(e,t)=>{e.sourceDocuments={...e.sourceDocuments,...t.payload}}),e.addCase(a.rejected,(e,t)=>{alert("TODO")})}});t.ZP=s.reducer;let i=e=>e.sourceDocuments.sourceDocuments},5749:function(e,t,r){r.d(t,{Fg:function(){return i},Ph:function(){return c},_E:function(){return o},xN:function(){return u}});var n=r(1876),l=r(1677);let a={searchTypeSettings:{fuzzySearch:!1},sourceSettings:{sources:null},filterSettings:{minimumDPI:l.sL,maximumDPI:l.gx,maximumSize:l.bD}},s=(0,n.oM)({name:"searchSettings",initialState:a,reducers:{setSearchTypeSettings:(e,t)=>{e.searchTypeSettings=t.payload},setSourceSettings:(e,t)=>{e.sourceSettings=t.payload},setFilterSettings:(e,t)=>{e.filterSettings=t.payload}}}),{setSearchTypeSettings:i,setSourceSettings:c,setFilterSettings:o}=s.actions;t.ZP=s.reducer;let u=e=>e.searchSettings},9547:function(e,t,r){r.d(t,{Z:function(){return ek}});var n,l,a=r(7297),s=r(5893),i=r(1163),c=r(4304),o=r(7294),u=r(682),d=r(3559),m=r(2664),f=r(9521),h=r(8356),p=r(1876),y=r(2283),g=r(8737),b=r(3152),v=r(9539),j=r(7088),x=r(5713),S=r(5582),k=r(5749),w=r(5384);let q=(0,h.UY)({[y.gk.reducerPath]:y.gk.reducer,viewSettings:w.ZP,searchSettings:k.ZP,searchResults:x.ZP,cardDocuments:j.ZP,cardbacks:b.ZP,sourceDocuments:S.ZP,project:v.ZP,backend:g.ZP}),Z=(0,p.xC)({reducer:q,preloadedState:void 0,middleware:e=>e().concat(y.gk.middleware)});var I=r(1677),C=r(975),D=r(4641),T=r(1664),P=r.n(T),E=r(7104),R=r(1555),N=r(4051),_=r(5015),O=r(2021),F=r(5152),z=r.n(F);let B=e=>(0,s.jsx)(o.Fragment,{children:e.children});var A=z()(()=>Promise.resolve(B),{ssr:!1});function V(){let e=(0,C._m)(),[t,r]=(0,o.useState)(!1),n=()=>{(0,C.Y9)(!0),r(!0)},l=()=>{(0,C.Y9)(!1),r(!0)};return(0,s.jsxs)(_.Z,{show:void 0==e&&!t,delay:3e3,animation:!0,children:[(0,s.jsx)(_.Z.Header,{closeButton:!1,children:(0,s.jsx)("strong",{className:"me-auto",children:"Cookie Usage"})}),(0,s.jsxs)(_.Z.Body,{children:[(0,s.jsxs)("p",{children:[I.vV," uses cookies for remembering your search settings, and for collecting analytics data to help improve the site. Your data is never shared with anyone. Would you like to opt out of analytics cookies?"]}),(0,s.jsxs)("p",{children:["View our privacy policy ",(0,s.jsx)(P(),{href:"/about",children:"here"}),"."]}),(0,s.jsx)("div",{className:"mt-2 pt-2 border-top",children:(0,s.jsxs)(N.Z,{children:[(0,s.jsx)(R.Z,{className:"d-grid gap-0",children:(0,s.jsx)(E.Z,{variant:"outline-info",size:"sm",onClick:l,children:"Opt out"})}),(0,s.jsx)(R.Z,{className:"d-grid gap-0",children:(0,s.jsx)(E.Z,{variant:"primary",size:"sm",onClick:n,children:"That's fine!"})})]})})]})]})}function L(){return(0,s.jsx)(A,{children:(0,s.jsx)(O.Z,{position:"top-start",children:(0,s.jsx)(V,{})})})}var M=r(5675),G=r.n(M),J=r(1451),U=r(9126),X=r(4214),W=r(5276),H=r.n(W),Y=r(8375),$=r(2914),Q=r(4874);r(1351),(n=l||(l={})).IN_PROGRESS="record-circle-fill",n.SUCCEEDED="check-circle-fill",n.FAILED="x-circle-fill";let K=["Validating URL","Pinging server","Checking search engine health"];function ee(e){let t=!1;try{new URL(e),t=!0}catch(e){}return t}async function et(e){let t=!1;try{let r=new(H());await r.ping(e,function(e,r){t=null==e})}catch(e){}return t}async function er(e){let t=!1;try{await fetch(new URL("2/searchEngineHealth/",e).toString(),{method:"GET",mode:"cors"}).then(e=>e.json()).then(e=>{var r;t=!0===(null!==(r=e.online)&&void 0!==r&&r)})}catch(e){}return t}function en(e){var t;let{show:r,handleClose:n}=e,a=(0,m.I0)(),[i,c]=(0,o.useState)([]),[u,d]=(0,o.useState)(!1),f=(0,m.v9)(g.If),h=()=>{a((0,g.LW)()),(0,C.j)(),a(y.gk.util.invalidateTags([I.Fj.BackendSpecific])),c([])},[p,b]=(0,o.useState)(""),v=async e=>{e.preventDefault(),d(!0);let t=(0,D.DE)(p.trim()),r=[];for(let e of(c(r),[ee,et,er])){r.push(l.IN_PROGRESS),c(r);let n=await e(t);if(c(r=[...r.slice(0,-1),n?l.SUCCEEDED:l.FAILED]),!n)break}r.every(e=>e===l.SUCCEEDED)&&(a((0,g.jb)(t)),(0,C.IT)(t),a(y.gk.util.invalidateTags([I.Fj.BackendSpecific])),b("")),d(!1)};return(0,o.useEffect)(()=>{let e=(0,C.Vs)();void 0!=e&&(a((0,g.jb)(e)),a(y.gk.util.invalidateTags([I.Fj.BackendSpecific])))},[]),(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(Q.Z,{show:r,onHide:n,children:[(0,s.jsx)(Q.Z.Header,{closeButton:!0,children:(0,s.jsx)(Q.Z.Title,{children:"Configure Server"})}),(0,s.jsxs)(Q.Z.Body,{children:[null!=f&&(0,s.jsxs)(Y.Z,{variant:"success",children:["You're currently connected to ",(0,s.jsx)("b",{children:f}),".",(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(E.Z,{variant:"danger",onClick:h,children:"Disconnect"})]}),"Enter the URL of the server you'd like to connect ",I.vV," ","to and hit ",(0,s.jsx)("b",{children:"Submit"}),".",(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)($.Z,{onSubmit:v,children:[(0,s.jsx)($.Z.Group,{className:"mb-3",controlId:"formURL",children:(0,s.jsx)($.Z.Control,{placeholder:"https://",onChange:e=>b(e.target.value),value:p,disabled:u})}),i.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("hr",{}),(0,s.jsx)("ul",{children:K.map((e,r)=>(0,s.jsxs)("li",{children:[(0,s.jsx)("i",{className:"bi bi-".concat(null!==(t=i[r])&&void 0!==t?t:"circle")})," ",e,i[r]===l.IN_PROGRESS&&"..."]},e))}),(0,s.jsx)("hr",{})]}),(0,s.jsx)(E.Z,{variant:"primary",type:"submit",disabled:u||0==p.trim().length,children:"Submit"})]})]})]})})}var el=r(6212),ea=r(5305);function es(e){var t,r,n,l;let{show:a,handleClose:i}=e,c=(0,m.v9)(g.If),o=(0,y.zr)(void 0,{skip:null==c});return(0,s.jsxs)(el.Z,{show:a,onHide:i,children:[(0,s.jsx)(el.Z.Header,{closeButton:!0,children:(0,s.jsxs)(el.Z.Title,{children:["Support ",null!==(n=null===(t=o.data)||void 0===t?void 0:t.name)&&void 0!==n?n:"Your Server Manager"]})}),(0,s.jsx)(el.Z.Body,{children:(null==o?void 0:null===(r=o.data)||void 0===r?void 0:r.patreon)==null?(0,s.jsx)(ea.$,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h4",{children:"Patron Tiers"}),Object.values(null!==(l=o.data.patreon.tiers)&&void 0!==l?l:{}).map(e=>(0,s.jsx)("h6",{children:(0,s.jsxs)("b",{children:[e.title," ($",e.usd," USD)"]})},"patreon-tier-".concat(e.title)))]})}),(0,s.jsx)(el.Z.Footer,{children:(0,s.jsx)(E.Z,{variant:"secondary",onClick:i,children:"Close"})})]})}function ei(){return(0,s.jsx)("a",{href:"https://www.buymeacoffee.com/chilli.axe",target:"_blank",children:(0,s.jsx)(G(),{className:"mx-auto d-block",src:"https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png",alt:"Buy Me A Coffee",width:217,height:60})})}function ec(e){let{show:t,handleClose:r}=e;return(0,s.jsxs)(el.Z,{show:t,onHide:r,children:[(0,s.jsx)(el.Z.Header,{closeButton:!0,children:(0,s.jsx)(el.Z.Title,{children:"Support the Developer"})}),(0,s.jsxs)(el.Z.Body,{children:[(0,s.jsx)("h4",{children:"A bit about me"}),(0,s.jsxs)("p",{children:["Hey there! Thanks for checking out ",I.vV,". I'm Nick, the creator and primary developer of this project."]}),(0,s.jsxs)("p",{children:["I'm responsible for this website, the code that image repository servers run on, and the desktop tool that automates"," ",(0,s.jsx)("a",{href:I.vs,target:"_blank",children:I.Fo}),"."]}),(0,s.jsxs)("p",{children:["I started developing ",I.vV," in early 2020 while I was in uni to simplify how the tabletop gaming community shares its MPC print-ready images — at the time, we were manually browsing through Google Drives to find cards we wanted to print and dragging & dropping them into MPC."]}),(0,s.jsxs)("p",{children:["These days, I'm working full-time and continuing to develop"," ",I.vV," by night, and I'm passionate about delivering the best print tooling I can to the tabletop gaming community."]}),(0,s.jsxs)("p",{children:[I.vV," is completely open source software (licensed under GPL-3) and all of its features will always be free."]}),(0,s.jsxs)("p",{children:["You can support my continued development of this project through"," ",(0,s.jsx)("i",{children:"Buy Me a Coffee"})," below ♥️"]}),(0,s.jsx)("h4",{children:"Where does my donation go?"}),(0,s.jsxs)("p",{children:["I don't host any ",I.vV," servers, just the website you're on right now — which GitHub allows me to host for free."]}),(0,s.jsx)("p",{children:"Any donation goes towards:"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"Fuelling my coffee addiction, and"}),(0,s.jsx)("li",{children:"Allowing me to spend more time developing and improving this project for you all. Several large features are in the pipeline that I'm excited to share when they're ready!"})]}),(0,s.jsx)("hr",{}),(0,s.jsx)(ei,{})]}),(0,s.jsx)(el.Z.Footer,{children:(0,s.jsx)(E.Z,{variant:"secondary",onClick:r,children:"Close"})})]})}function eo(){let e=(0,a.Z)(["\n  max-width: ","px;\n"]);return eo=function(){return e},e}function eu(){let e=(0,a.Z)(["\n  --bs-navbar-padding-y: 0px;\n"]);return eu=function(){return e},e}function ed(){let e=(0,a.Z)(["\n  font-weight: bold;\n"]);return ed=function(){return e},e}let em=(0,f.ZP)(u.Z).withConfig({componentId:"sc-a32994b7-0"})(eo(),I.xk),ef=(0,f.ZP)(U.Z).withConfig({componentId:"sc-a32994b7-1"})(eu()),eh=(0,f.ZP)(U.Z.Collapse).withConfig({componentId:"sc-a32994b7-2"})(ed());function ep(){var e,t,r,n,l,a;let i=(0,m.v9)(g.If),c=(0,y.zr)(void 0,{skip:null==i}),[u,d]=(0,o.useState)(!1),[f,h]=(0,o.useState)(!1),[p,b]=(0,o.useState)(!1),v=()=>d(!1),j=()=>d(!0),x=()=>h(!1),S=()=>h(!0),k=()=>b(!1),w=()=>b(!0),q=null!==(l=c.isSuccess?null===(e=c.data)||void 0===e?void 0:e.name:null)&&void 0!==l?l:I.vV;return(0,s.jsxs)(A,{children:[(0,s.jsx)(ef,{expand:"lg",fixed:"top",variant:"dark",bg:"primary",children:(0,s.jsxs)(em,{className:"justify-content-center align-middle",children:[(0,s.jsxs)(U.Z.Brand,{href:"/",as:P(),children:[(0,s.jsx)(G(),{src:"/logolowres.png",alt:"logo",width:I.mo,height:I.mo})," ",(0,s.jsx)("span",{className:"align-middle",children:(0,s.jsx)("b",{children:q})})]}),(0,s.jsx)(U.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,s.jsxs)(eh,{id:"basic-navbar-nav",children:[(0,s.jsxs)(J.Z,{className:"me-auto",children:[null!=i&&(0,s.jsx)(J.Z.Link,{as:P(),href:"/editor",children:"Editor"}),(0,s.jsx)(J.Z.Link,{as:P(),href:"/guide",children:"Guide"}),null!=i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(J.Z.Link,{as:P(),href:"/new",children:"What's New?"}),(0,s.jsx)(J.Z.Link,{as:P(),href:"/contributions",children:"Contributions"})]}),(0,s.jsx)(J.Z.Link,{href:"https://github.com/chilli-axe/mpc-autofill/releases",target:"_blank",children:"Download"}),(0,s.jsxs)(X.Z,{title:"Donate",children:[(0,s.jsxs)(X.Z.Item,{onClick:S,children:[(0,s.jsx)("i",{className:"bi bi-code"})," Support the Developer"]}),(null===(t=c.data)||void 0===t?void 0:t.name)!=null&&(null!==(a=null===(r=c.data)||void 0===r?void 0:null===(n=r.patreon)||void 0===n?void 0:n.url)&&void 0!==a?a:"").trim().length>0&&(0,s.jsxs)(X.Z.Item,{onClick:w,children:[(0,s.jsx)("i",{className:"bi bi-server"})," Support"," ",c.data.name]})]})]}),(0,s.jsx)(J.Z,{className:"ms-auto d-flex",children:(0,s.jsx)(E.Z,{className:"my-xl-0 my-lg-0 my-md-2 my-sm-2 my-2",variant:"success",onClick:j,children:"Configure Server"})})]})]})}),(0,s.jsx)(en,{show:u,handleClose:v}),(0,s.jsx)(ec,{show:f,handleClose:x}),(0,s.jsx)(es,{show:p,handleClose:k})]})}function ey(){let e=(0,a.Z)(["\n  overscroll-behavior: none;\n  overflow-x: hidden;\n  overflow-y: hidden; // https://stackoverflow.com/a/69589919/13021511\n"]);return ey=function(){return e},e}function eg(){let e=(0,a.Z)(["\n  top: ","px;\n  height: calc(\n    100vh - ","px\n  ); // for compatibility with older browsers\n  height: calc(100dvh - ","px); // handles the ios address bar\n  position: fixed;\n  overflow-y: scroll;\n  overflow-x: hidden;\n"]);return eg=function(){return e},e}function eb(){let e=(0,a.Z)(["\n  max-width: ","px;\n"]);return eb=function(){return e},e}function ev(){let e=(0,i.useRouter)(),{server:t}=e.query,r=null!=t&&"string"==typeof t&&t.length>0?(0,D.DE)(t.trim()):null,n=(0,m.I0)(),l=(0,m.v9)(g.If);return(0,o.useEffect)(()=>{null==l&&null!=r&&(n((0,g.jb)(r)),(0,C.IT)(r),null!=t&&"string"==typeof t&&t.length>0&&e.replace({server:t},void 0,{shallow:!0}))},[e.isReady,l,r,n]),(0,s.jsx)(s.Fragment,{})}let ej=(0,f.ZP)(m.zt).withConfig({componentId:"sc-8534e505-0"})(ey()),ex=(0,f.ZP)(u.Z).withConfig({componentId:"sc-8534e505-1"})(eg(),I.tm,I.tm,I.tm),eS=(0,f.ZP)(u.Z).withConfig({componentId:"sc-8534e505-2"})(eb(),I.xk);function ek(e){let{gutter:t=2,children:r}=e,n=(0,C._m)();return(0,s.jsxs)(s.Fragment,{children:[!0===n&&(0,s.jsx)(c.Wi,{trackPageViews:!0}),(0,s.jsx)(d.Z,{children:(0,s.jsxs)(ej,{store:Z,children:[(0,s.jsx)(L,{}),(0,s.jsx)(ev,{}),(0,s.jsx)(ep,{}),(0,s.jsx)(ex,{fluid:!0,className:"g-".concat(t),children:(0,s.jsx)(eS,{className:"g-".concat(t),children:r})})]})})]})}},5305:function(e,t,r){r.d(t,{$:function(){return u}});var n,l,a=r(7297),s=r(5893);r(7294);var i=r(9521);function c(){let e=(0,a.Z)(["\n  width: ","em;\n  height: ","em;\n"]);return c=function(){return e},e}let o=i.ZP.div.withConfig({componentId:"sc-ff15f3e1-0"})(c(),e=>null!==(n=e.size)&&void 0!==n?n:4,e=>null!==(l=e.size)&&void 0!==l?l:4);function u(e){let{size:t=4}=e;return(0,s.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,s.jsx)(o,{size:t,className:"spinner-border",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})}},5384:function(e,t,r){r.d(t,{$3:function(){return i},Mo:function(){return d},O6:function(){return c},X8:function(){return o},tC:function(){return u}});var n=r(1876);let l=(0,n.oM)({name:"cardGrid",initialState:{frontsVisible:!0,sourcesVisible:{},facetBySource:!0},reducers:{switchToFront:e=>{e.frontsVisible=!0},switchToBack:e=>{e.frontsVisible=!1},toggleFaces:e=>{e.frontsVisible=!e.frontsVisible},toggleSourceVisible:(e,t)=>{var r;e.sourcesVisible={...e.sourcesVisible,[t.payload]:!(null===(r=e.sourcesVisible[t.payload])||void 0===r||r)}},makeAllSourcesVisible:e=>{e.sourcesVisible={}},makeAllSourcesInvisible:(e,t)=>{e.sourcesVisible=Object.fromEntries(t.payload.map(e=>[e,!1]))},toggleFacetBySource:e=>{e.facetBySource=!e.facetBySource}}}),{switchToFront:a,switchToBack:s,toggleFaces:i,toggleSourceVisible:c,makeAllSourcesVisible:o,makeAllSourcesInvisible:u,toggleFacetBySource:d}=l.actions;t.ZP=l.reducer}}]);